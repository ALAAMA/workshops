Introduc)ontoGraphicswith Stata IstaZahn HarvardMITData Center 1 Organiza)on • Pleasefeelfreetoaskques)onsaanypoint iftheyarerelevant tothecurrent topic(orifyouarelost!)• TherewillbeQ&AaLerclassformorespecific,personalizedques)ons• Collabora)onwithyourneighborsisencouraged• Ifyouareusinglaptop,youwillneedtoadjust pathsaccordingly2 Organiza)on • MakecommentsinyourDo-..fileratherthanonhand-..outs– Saveonflashdriveoremailtoyourself• Statacommandswillalwaysappearinred• “Var”simplyrefersto“variable”(e.g.,var1,var2,var3,varname) • “pathname”shouldbereplacewiththepathspecifictoyourcomputerandfolders3 Assump)onsandDisclaimers • ThisisanINTRODUCTIONtographinginStata • AssumesbasicknowledgeofStata• Not appropriateforpeoplealreadywellfamiliarwithgraphinginStata• Ifyouarecatchingonbeforetherest oftheclass,experiment withcommandfeaturesdescribed ihelp files 4 Assump)onsandDisclaimers• I’mgoingtogiveyouanoverviewofStata’scapabili)es• won’t beabletocovereverygraphingcapabilityyou’lleverneed!• Taketheseskillsbuildonthemandfindwhat worksforyou5 GraphingStrategies• Keepit simple• Labels,labels,labels!!• Avoidcluaeredgraphs• Everypart ofthegraphshouldbemeaningful • Avoid: – Shading– Distrac)ngcolors– Decora)on6 TerribleGraphs 7 Less Terrible 8 Probability of High School Graduation Graduation BeaerGraph0.99 0.98 0.97 0.96 0.94 0.95 Male Female 0.93 -1 0 1 Level of Neighborhood Socioeconomic Status (Standardized) Figure 1. Two-way interaction of gender by the standardized measure of neighborhood socioeconomic status on probability of graduating from high school. 9 Opening Stata • OnceyouhaveStataopen,let’scallupthedatafilefortoday– Step1:tellStatawheretofinddata:cd“~/StataGraphics” – Step2:callupourdataset:usestates.dta10 BasicGraphing • Alwaysknowwhat you’reworkingwithbeforeyouget started– Recognizescaleofdata – Ifyou’reusingmul)plevariableshowdotheirscalesalign?• Beforeanygraphingprocedurereviewvariableswithcodebooksumtab,etc.• HELPFULSTATAHINT:Ifyouwant yourcommandtogoonmul)plelinesuse“///”atendofeachline11 BasicGraphing:SingleCon)nuous Variables Example:Histograms• Stataassumesyou’reworkingwithcon)nuousdata • Verysimplesyntax:– histvarname• Put comma aLeryourvarnameandstart addingop)ons– bin(#):changethenumberofbarsthat thegraphdisplays– normal:overlaynormalcurve– addlabels:addactualvaluestobars12 OurFirst Dataset • TimeMagazinePublicSchoolPoll• Basedonsurveyof1,000adultsinU.S.• ConductedinAugust 2010• Ques)onsregardingfeelingsabout parentalinvolvement,teachersunion,current poten)alforreform13 BasicGraphing:SingleCon)nuous Variables Example:Histograms• Changethenumericdepic)onofyourdata • Addtheseop)onsaLerthecomma – Chooseone:densityfrac)onfrequencypercent • histvarname,percent 14 BasicGraphing:SingleCon)nuous Variables Example:Histograms • Besuretoproperlydescribeyourhistogram:– )tle(insert nameofgraph)– sub)tle(insert sub1tleofgraph)– note(insert notetoappearat bo3om ofgraph) – cap)on(insert cap1ontoappearbelownotes)15BasicGraphing:SingleCon)nuous Variables histF1,bin(10)percent )tle(TITLE)sub)tle(SUBTITLE)cap)on(CAPTION)note(NOTES) TITLE 0 5 10 15 20 Percent SUBTITLE 0 NOTES CAPTION 2 4 6 F1. What is your age? 8 16BasicGraphing:SingleCon)nuous Variables Example:Histograms • Axis)tleop)ons(default isvariablelabel):– x)tle(insert xaxisname)– y)tle(insert yaxisname)• Don’t want axis)tles?– x)tle(“”)– y)tle(“”)17BasicGraphing:SingleCon)nuous Variables Example:Histograms • AddlabelstoorYaxis:– xlabel(insert xaxislabel)– ylabel(insert yaxislabel)• Tell Statahowtoscaleeachaxis– xlabel(start#(increment)end#)– xlabel(0(5)100) • Thiswouldlabelx-..axisfrom0-..100inincrementsof518BasicGraphing:SingleCon)nuous Variables histF1,bin(10)percent )tle(TITLE)sub)tle(SUBTITLE)cap)on(CAPTION)///note(NOTES)x)tle(Here'syourx-..axis)tle)y)tle(here'syoury-..axis)tle)TITLE SUBTITLE 0 5 10 15 20 0 NOTES 2 4 6 Here's your x-axis title 8 CAPTION 19BasicGraphing:SingleCategorical Variables Example:Histograms• What ifmyvariableisnot con)nuous?– Simplyspecify“discrete”withop)ons• Statawillproduceonebarforeachlevel(i.e.category)ofvariable• Use xlabelcommandtoinsert namesofindividualcategories– …,xlabel(1"White"2"Black"3"Asian"4 "Hispanic"5"Other") 20 BasicGraphing:SingleCategorical Variables histF4,)tle(RacialbreakdownofTimePollSample)x)tle(Race)///y)tle(Percent)xlabel(1"White"2"Black"3"Asian"4"Hispanic“///5"Other")discretepercent addlabels80.99 10.36 1.408 3.32 3.924 0 20 40 60 80 Percent Racial breakdown of Time Poll Sample White Black Asian Hispanic Other Race *Notemyuseofthe“///”toallowthecommandtocon)nueonmul)plelines21ComparingResponsesAcross CategoricalVariables tabplotrvbQ8frequency Democratic State Republican State Teaching skills they will needNot teaching them(VOL) No answer/Don't knowQ8. Do you think that the public schools overall are teaching students the skill maximum: 297 22 ComparingResponsesAcross CategoricalVariablestabplotrvbQ8,percent(Q8))tle("Doyouthinkpublicschoolsare"///"teachingstudentstheskillstheyneed?")sub)tle("")x)tle("") y)tle("") ///xlabel(1 "Yes" "No" 3"No Answer") Do you think public schools areteaching students the skills they need? Republican State Democratic State Yes No No Answer maximum: 56.3 23Exercise1:HistogramsandTab Plots 24 TheTwowayFamily • Next Dataset:– Na)onalNeighborhoodCrimeStudy(NNCS)– N=9,593censustractsin2000– Exploresourcesofvaria)onincrimefor communi)esintheUnitedStates • Tract-..leveldata:crime,socialdisorganiza)on,disadvantage,socioeconomicinequality• City-..leveldata:labormarket,socioeconomicinequality,popula)onchange25 TheTwowayFamily• twowayisbasicStatacommandforalltwowaygraphs• Use twowayany)meyouwant tomakecomparisonsamongvariables• Canbeusedtocombinegraphs(i.e.,overlayonegraphwithanother– e.g.,insert lineofbest fit overscaaerplot 26 TheTwowayFamily • Most basic:– twscaaerT_PERCAPT_VIOLNT– twdroplineT_PERCAPT_VIOLNT– twlfitciT_PERCAPT_VIOLNT 27 Twoways and the By Statement twoway scaaer T_PERCAP T_VIOLNT, by(DICEMP) 0 50000 100000 150000 0 500 1000 1500 2000 0 500 1000 1500 2000 Unemployment in Lower 50% Unemployment Rate in Upper 50% Per capita income in 1999 Sum of numbers of violent crimes Graphs by Median split of unemployment 28 Twoway Title Op)ons • Same)tleop)onsaswithhistogram– )tle(insert nameofgraph)– sub)tle(insert sub1tleofgraph)– note(insert notetoappearat bo3om ofgraph)– cap)on(insert cap1ontoappearbelownotes)29 Twoway Title Op)ons 0 50000 100000 150000 Per Capita Income 0 500 1000 1500 2000 Violent Crime Rate Source: National Neighborhood Crime Study 2000 Comparison of Per Capita Income and Violent Crime Rate at Tract level twoway scaaer T_PERCAP T_VIOLNT, )tle(Comparison of Per Capita Income and Violent Crime Rate at Tract level) /// x)tle(Violent Crime Rate) y)tle(Per Capita Income) note(Source: Na)onal Neighborhood Crime Study 2000) Let’s fix that graph )tle – it is too cramped…. 30 Twoway Title Op)ons twoway scaaer T_PERCAP T_VIOLNT, )tle("Comparison of Per Capita Income" /// "and Violent Crime Rate at Tract level") /// x)tle(Violent Crime Rate) y)tle(Per Capita Income) /// note(Source: Na)onal Neighborhood Crime Study 2000) 0 50000 100000 150000 Per Capita Income 0 500 1000 1500 2000 Violent Crime Rate Source: National Neighborhood Crime Study 2000 Comparison of Per Capita Income and Violent Crime Rate at Tract level *Note how we got our )tle to go onto two lines 31 Twoway Symbol Op)ons -..Tocallthischart upinStata,type:paleaesymbolpaleaeUsemsymbol() ingraphop)onstochangesymbolSymbol palette O Oh o oh D Dh d dh T Th t th S Sh s sh + X smplus x p (symbols shown at larger than default size) 32 Twoway Symbol Op)ons 0 50000 100000 150000 Per Capita Income 0 500 1000 1500 2000 Violent Crime Rate Source: National Neighborhood Crime Study 2000 Comparison of Per Capita Income and Violent Crime Rate at Tract level twoway scaaer T_PERCAP T_VIOLNT, )tle("Comparison of Per Capita Income" /// "and Violent Crime Rate at Tract level") /// x)tle(Violent Crime Rate) y)tle(Per Capita Income) /// note(Source: Na)onal Neighborhood Crime Study 2000) /// msymbol(Sh) Here’s my msymbol() op)on 33 Twoway Symbol Op)ons 0 50000 100000 150000 Per Capita Income 0 500 1000 1500 2000 Violent Crime Rate Source: National Neighborhood Crime Study 2000 Comparison of Per Capita Income and Violent Crime Rate at Tract level Add “mcolor(insert color)” op)on to change color of symbol. Here, I just added “mcolor(red)” to the graph op)ons. 34 Overlaying Twoway Graphs • Verysimpletocombinemul)plegraphs…just put eachgraphcommandinparentheses– twoway(scaaervar1var2)(lfitvar1var2)• Addindividualop)onstoeachgraphwithintheparentheses• Addoverallgraphop)onsasusualfollowingthecomma – twoway(scaaervar1var2)(lfitvar1var2),op)ons35 Overlaying Twoway Graphs -50000 0 50000 100000 150000 Per Capita Income 0 500 1000 1500 2000 Violent Crime Rate Per capita income in 1999 Fitted values Source: National Neighborhood Crime Study 2000 Comparison of Per Capita Income and Violent Crime Rate at Tract level twoway (scaaer T_PERCAP T_VIOLNT) (lfit T_PERCAP T_VIOLNT), )tle("Comparison of /// Per Capita Income" "and Violent Crime Rate at Tract level“) /// x)tle(Violent Crime Rate) y)tle(Per Capita Income) note(Source: Na)onal /// Neighborhood Crime Study 2000) 36 Overlaying Twoway Graphs Los AngelesCA 0 50000 100000 150000 Per capita income in 1999 0 200 400 600 800 1000 1200 1400 1600 1800 2000 2200 2400 Sum of numbers of violent crimes Source: National Neighborhood Crime Study 2000 Comparison of Per Capita Income and Violent Crime Rate at Tract level twoway (scaaer T_PERCAP T_VIOLNT if T_VIOLNT==1976, mlabel(CITY)) (scaaer T_PERCAP T_VIOLNT), /// )tle("Comparison of Per Capita Income" "and Violent Crime Rate at Tract level") xlabel(0(200)2400) /// note(Source: Na)onal Neighborhood Crime Study 2000) legend(off) 37 Exercise 2: The TwoWay Family 38 BonusMaterial! 39 LineGraphs • Linegraphshelpfulforvarietyofdata – Especiallyanytypeof)meseriesdata • We’llusedata onUSlifeexpectancyfrom1900-..1999– webuseuslifeexp,clear40 LineGraphslinele_wmle_bmyear*Simplelinegraphofmenandwomenover)me40 50 60 70 80 1900 1920 1940 1960 1980 2000 Year Life expectancy, males Life expectancy, females 41 LineGraphslinele_wfemalele_wmalele_wmle_bmyear30 40 50 60 70 80 1900 1920 1940 Year 1960 1980 2000 Life expectancy, white females Life expectancy, white males Life expectancy, white males Life expectancy, black males 42 LineGraphs:AddingOp)ons • Asusual…just keepaddingop)onsaLerthecomma!• Samerulesapplyfor)tlesthat we’vealready seenforhistogramsandthetwowaygraphs • Let’sreviewhowwecanplaywiththeappearanceofourlines• Fulllis)ngofop)onstype“help line_op)ons” 43LineGraphs:ChangingOp)ons linele_wfemalele_wmalele_bfle_bmyear,lpaaern(dot soliddot solid) 30 40 50 60 70 80 1900 1920 1940 Year 1960 1980 2000 Life expectancy, white females Life expectancy, black females Life expectancy, white males Life expectancy, black males “lpaaern()”commandallowsmetochangepaaernfromsolidtodoaed 44 StataGraphingLinesTocallthisupinStata,type:paleaelinepaleaeLine pattern palette solid dash longdash_dot dot longdash dash_dot shortdash shortdash_dot blank 45 30 40 50 60 70 80 1900 1920 1940 Year 1960 1980 2000 Life expectancy, white females Life expectancy, black females Life expectancy, white males Life expectancy, black males LineGraphs:ChangingOp)onslinele_wfemalele_wmalele_bfle_bmyear,lpaaern(dot soliddot solid)///lcolor(red bluered blue) lwidth(thickthinthickthin)NowI’veusedseveraldifferent op)onstochangelinepaaern,colorandwidth46 ProfilePlots • Great wayforcomparingoutcomesoncon)nuousvariablesacrossdifferent levelsofcategoricalvariables• Example:math,scienceandreadingscores(con)nuousvariables)acrossdifferent curriculumprograms• ProfileplotsisStataadd-..on(not inbasepackage)– finditprofileplot47 ProfilePlot • Let’sgobacktotheNa)onalCrimeSurveyandlookacrimeratesacrossdifferent levelsofunemployment athetract level• First,createcategoricalvariablesepara)ngunemployment ratesintoquar)les– *payaaen)ontowhat happenswithmissingdata • Labelnewvariable48 ProfilePlotsprofileplotT_MURDRTT_AGASRTT_VIOLRTT_PROPRT,by(unempquart) 0 20 40 60 80 mean T_MURDRT T_AGASRT T_VIOLRT T_PROPRT Variables Lowest 25th 25-50th 50-75th Highest 25th mean 49 ProfilePlots profileplotT_MURDRTT_AGASRTT_VIOLRTT_PROPRT,by(unempquart) xlabel(1"Murder"2"Assault"3"Violent"4"Property")///y)tle(AverageCrimeRate))tle("AverageTract CrimeRatesbyUnemployment Level")x)tle("") 0 20 40 60 80 Murder Assault Violent Property Variables Lowest 25th 25-50th 50-75th Highest 25th mean Average Tract Crime Rates by Unemployment Level 50 Expor)ngGraphs • FromStata,right clickonimageandselect “saveas”ortrysyntax:– cd“~/StataGraphics” – graphexport myfig.esp,replace• InMicrosoLWord:insertpicturefromfile – Or,right clickongraphinStataandcopyandpasteintoWord51 