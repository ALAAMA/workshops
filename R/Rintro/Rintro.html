<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-05-23 Mon 15:51 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title>Introduction to R</title>
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Ista Zahn" />
<link rel="stylesheet" type="text/css" href="http://tutorials.iq.harvard.edu/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://tutorials.iq.harvard.edu/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://tutorials.iq.harvard.edu/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<a href="https://github.com/izahn/workshops"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/652c5b9acfaddf3a9c326fa6bde407b87f7be0f4/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6f72616e67655f6666373630302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png"></a>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Introduction to R</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline5">Workshop Materials and Introduction</a>
<ul>
<li><a href="#orgheadline1">Materials and setup</a></li>
<li><a href="#orgheadline2">What is R?</a></li>
<li><a href="#orgheadline3">InspiRation</a></li>
<li><a href="#orgheadline4">Coming to R</a></li>
</ul>
</li>
<li><a href="#orgheadline9">Graphical User Interfaces (GUIs)</a>
<ul>
<li><a href="#orgheadline6">R GUI alternatives</a></li>
<li><a href="#orgheadline7">Launch RStudio&#xa0;&#xa0;&#xa0;<span class="tag"><span class="labsetup">labsetup</span></span></a></li>
<li><a href="#orgheadline8">Exercise 0</a></li>
</ul>
</li>
<li><a href="#orgheadline12">Data and Functions</a>
<ul>
<li><a href="#orgheadline10">Assignment</a></li>
<li><a href="#orgheadline11">Functions</a></li>
</ul>
</li>
<li><a href="#orgheadline13">R packages</a></li>
<li><a href="#orgheadline21">Getting data into R</a>
<ul>
<li><a href="#orgheadline14">The gss dataset</a></li>
<li><a href="#orgheadline15">The "working directory" and listing files</a></li>
<li><a href="#orgheadline16">Importing data from files the easy way</a></li>
<li><a href="#orgheadline17">Importing data from files the hard way</a></li>
<li><a href="#orgheadline18">Checking imported data</a></li>
<li><a href="#orgheadline19">Saving and loading R  workspaces</a></li>
<li><a href="#orgheadline20">Exercise 1</a></li>
</ul>
</li>
<li><a href="#orgheadline22">Asking R for help</a></li>
<li><a href="#orgheadline28">Data Manipulation</a>
<ul>
<li><a href="#orgheadline23">data.frame objects</a></li>
<li><a href="#orgheadline24">Extracting subsets of data.frames</a></li>
<li><a href="#orgheadline25">Transforming data.frames</a></li>
<li><a href="#orgheadline26">Exporting Data</a></li>
<li><a href="#orgheadline27">Exercise 2: Data manipulation</a></li>
</ul>
</li>
<li><a href="#orgheadline39">Basic Statistics and Graphs</a>
<ul>
<li><a href="#orgheadline29">Basic statistics</a></li>
<li><a href="#orgheadline30">Counts and proportions</a></li>
<li><a href="#orgheadline31">Statistics by classification factors</a></li>
<li><a href="#orgheadline32">Correlations</a></li>
<li><a href="#orgheadline33">Multiple regression</a></li>
<li><a href="#orgheadline34">Save R output to a file</a></li>
<li><a href="#orgheadline35">Basic graphics: Frequency bars</a></li>
<li><a href="#orgheadline36">Basic graphics: Boxplots by group</a></li>
<li><a href="#orgheadline37">Basic graphics: Mosaic chart</a></li>
<li><a href="#orgheadline38">Exercise 3</a></li>
</ul>
</li>
<li><a href="#orgheadline42">Wrap-up</a>
<ul>
<li><a href="#orgheadline40">Help us make this workshop better!</a></li>
<li><a href="#orgheadline41">Additional resources</a></li>
</ul>
</li>
<li><a href="#orgheadline43">Exercise solutions</a>
<ul>
<li><a href="#orgheadline44">Exercise 0 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline45">Exercise 1 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline46">Exercise 2 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline47">Exercise 3 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5">Workshop Materials and Introduction</h2>
<div class="outline-text-2" id="text-orgheadline5">
</div><div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1">Materials and setup</h3>
<div class="outline-text-3" id="text-orgheadline1">
<p>
You should have R installed &#x2013;if not:
</p>
<ul class="org-ul">
<li>Open a web browser and go to <a href="http://cran.r-project.org/">http://cran.r-project.org/</a> and download and install it</li>
<li>Also helpful to install RStudio (download from <a href="http://rstudio.com/">http://rstudio.com/</a>)</li>
</ul>

<p>
Download workshop materials:
</p>
<ul class="org-ul">
<li>Download materials from <a href="http://tutorials.iq.harvard.edu/R/Rintro.zip">http://tutorials.iq.harvard.edu/R/Rintro.zip</a></li>
<li>Extract the zip file containing the materials to your desktop</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2">What is R?</h3>
<div class="outline-text-3" id="text-orgheadline2">
<p>
R is a <i>programming language designed for statistical computing</i>. Notable characteristics include:
</p>
<ul class="org-ul">
<li>Vast capabilities, wide range of statistical and graphical techniques</li>
<li>Very popular in academia, growing popularity in business: <a href="http://r4stats.com/articles/popularity/">http://r4stats.com/articles/popularity/</a></li>
<li>Written primarily by statisticians</li>
<li>FREE (no cost, open source)</li>
<li>Excellent community support: mailing list, blogs, tutorials</li>
<li>Easy to extend by writing new functions</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3">InspiRation</h3>
<div class="outline-text-3" id="text-orgheadline3">
<p>
OK, it's free and popular, but what makes R worth learning? In a word,
"packages". If you have a data manipulation, analysis or visualization
task, chances are good that there is an R package for that. For example:
</p>

<ul class="org-ul">
<li>Want to interactively explore the shape of the Churyumovâ€“Gerasimenko comet?</li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-constant">library</span>(rgl)
open3d()
comet <span class="org-constant">&lt;-</span> readOBJ(url(<span class="org-string">"http://sci.esa.int/science-e/www/object/doc.cfm?fobjectid=54726"</span>))
shade3d(comet, col=<span class="org-string">"gray"</span>)
writeWebGL(dir=<span class="org-string">"images"</span>, filename = <span class="org-string">"images/comet.html"</span>)
</pre>
</div>

<iframe src="images/comet.html" width=600 height=350 scrolling=no seamless></iframe>

<ul class="org-ul">
<li>Want to find out where we are?</li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-constant">library</span>(ggmap)
nwbuilding <span class="org-constant">&lt;-</span> geocode(<span class="org-string">"1737 Cambridge Street Cambridge, MA 02138"</span>, <span class="org-constant">source</span> = <span class="org-string">"google"</span>) 
ggmap(get_map(<span class="org-string">"Cambridge, MA"</span>, zoom = <span class="org-highlight-numbers-number">15</span>)) +
  geom_point(data=nwbuilding, size = <span class="org-highlight-numbers-number">7</span>, shape = <span class="org-highlight-numbers-number">13</span>, color = <span class="org-string">"red"</span>)
</pre>
</div>


<div class="figure">
<p><img src="images/hereweare.png" alt="hereweare.png" />
</p>
</div>

<ul class="org-ul">
<li>Want to forecast the population of Australia?</li>
</ul>
<div class="org-src-container">

<pre class="src src-R"><span class="org-constant">library</span>(forecast)
fit <span class="org-constant">&lt;-</span> auto.arima(austres)
<span class="org-comment-delimiter">## </span><span class="org-comment">Projected numbers (in thousands) of Australian residents</span>
plot(forecast(fit))
</pre>
</div>


<div class="figure">
<p><img src="images/austop.png" alt="austop.png" />
</p>
</div>

<p>
Whatever you're trying to do, you're probably not the first to try doing it R. Chances are good that someone has already written a package for that.
</p>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-3">
<h3 id="orgheadline4">Coming to R</h3>
<div class="outline-text-3" id="text-orgheadline4">
<p>
Coming from&#x2026;
</p>
<dl class="org-dl">
<dt>Stata</dt><dd><a href="http://www.princeton.edu/~otorres/RStata.pdf">http://www.princeton.edu/~otorres/RStata.pdf</a></dd>
<dt>SAS/SPSS</dt><dd><a href="http://www.et.bs.ehu.es/~etptupaf/pub/R/RforSAS&amp;SPSSusers.pdf">http://www.et.bs.ehu.es/~etptupaf/pub/R/RforSAS&amp;SPSSusers.pdf</a></dd>
<dt>matlab</dt><dd><a href="http://www.math.umaine.edu/~hiebeler/comp/matlabR.pdf">http://www.math.umaine.edu/~hiebeler/comp/matlabR.pdf</a></dd>
<dt>Python</dt><dd><a href="http://mathesaurus.sourceforge.net/matlab-python-xref.pdf">http://mathesaurus.sourceforge.net/matlab-python-xref.pdf</a></dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-2">
<h2 id="orgheadline9">Graphical User Interfaces (GUIs)</h2>
<div class="outline-text-2" id="text-orgheadline9">
</div><div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6">R GUI alternatives</h3>
<div class="outline-text-3" id="text-orgheadline6">
<p>
The old-school way is to run R directly in a terminal
</p>


<div class="figure">
<p><img src="images/Rconsole.png" alt="Rconsole.png" width="95%" />
</p>
</div>

<p>
But hardly anybody does it that way anymore! The Windows versio of R comes with a GUI that looks like this:
</p>


<div class="figure">
<p><img src="images/Rgui.png" alt="Rgui.png" width="95%" />
</p>
</div>

<p>
The default windows GUI is not very good
</p>
<ul class="org-ul">
<li>No parentheses matching or syntax highlighting</li>
<li>No work-space browser</li>
</ul>

<p>
RStudio (an alternative GUI for R) is shown below.
</p>

<div class="figure">
<p><img src="images/Rstudio.png" alt="Rstudio.png" width="95%" />
</p>
</div>

<p>
Rstudio has many useful features, including parentheses matching and auto-completion. Rstudio is not the only advanced R interface; other alteratives include Emacs with ESS (shown below).
</p>


<div class="figure">
<p><img src="images/emacs.png" alt="emacs.png" width="95%" />
</p>
</div>

<p>
Emacs + ESS is a very powerful combination, but can be difficult to set up.
</p>


<div class="figure">
<p><img src="images/Jupyter.png" alt="Jupyter.png" width="95%" />
</p>
</div>

<p>
Jupyter is a notebook interface that runs in your web browser. A lot of people like it.
</p>
</div>
</div>

<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7">Launch RStudio&#xa0;&#xa0;&#xa0;<span class="tag"><span class="labsetup">labsetup</span></span></h3>
<div class="outline-text-3" id="text-orgheadline7">
<ul class="org-ul">
<li>Open the RStudio program</li>
<li>Open up today's R script
<ul class="org-ul">
<li>In RStudio, Go to <b>File =&gt; Open Script</b></li>
<li>Locate and open the <code>Rintro.R</code> script in the Rintro folder on your desktop</li>
</ul></li>
<li>Go to <b>Tools =&gt; Set working directory =&gt; To source file location</b> (more on the working directory later)</li>
<li>I encourage you to add your own notes to this file! Every line that starts with <code>#</code> is a comment that will be ignored by R. My comments all start with <code>##</code>; you can add your own, possibly using <code>#</code> or <code>###</code> to distinguish your comments from mine.</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8">Exercise 0</h3>
<div class="outline-text-3" id="text-orgheadline8">
<p>
The purpose of this exercise is mostly to give you an opportunity to explore the interface provided by RStudio (or whichever GUI you've decided to use). You may not know how to do these things; that's fine! This is an opportunity to learn. If you don't know how to do something you can can use internet search engines, search on <a href="http:stackoverflow.com">StackOverflow</a>, or ask the person next to you.
</p>

<p>
Also keep in mind that we are living in a golden age of tab completion. If you don't know the name of an R function, try guessing the first two or three letters and pressing TAB. If you guessed correctly the function you are looking for should appear in a pop up! 
</p>

<ol class="org-ol">
<li>Try to get R to add 2 plus 2.</li>
<li>Try to calculate the square root of 10.</li>
<li>There is an R package named <code>car</code> (Companion to Applied Regression). Try to install this package.</li>
<li>R includes extensive documentation, including a file named "An introduction to R". Try to find this help file.</li>
<li>Go to <a href="http://cran.r-project.org/web/views/">http://cran.r-project.org/web/views/</a> and skim the topic closest to your field/interests.</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgheadline12" class="outline-2">
<h2 id="orgheadline12">Data and Functions</h2>
<div class="outline-text-2" id="text-orgheadline12">
</div><div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10">Assignment</h3>
<div class="outline-text-3" id="text-orgheadline10">
<p>
Values can be assigned names and used in subsequent operations
</p>
<ul class="org-ul">
<li>The <code>&lt;-</code> operator (less than followed by a dash) is used to save values</li>
<li>The name on the left gets the value on the right.</li>
</ul>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock1">x <span class="org-constant">&lt;-</span> <span class="org-highlight-numbers-number">10</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Assign the value 10 to a variable named x</span>
x + <span class="org-highlight-numbers-number">1</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Add 1 to x</span>
y <span class="org-constant">&lt;-</span> x + <span class="org-highlight-numbers-number">1</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Assign y the value x + 1</span>
y
</pre>
</div>

<pre class="example">
&gt; x &lt;- 10 # Assign the value 10 to a variable named x
&gt; x + 1 # Add 1 to x
[1] 11
&gt; y &lt;- x + 1 # Assign y the value x + 1
&gt; y
[1] 11
&gt;
</pre>


<p>
Saved variables can be listed, overwritten and deleted
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock2">ls() <span class="org-comment-delimiter"># </span><span class="org-comment">List variables in workspace</span>
x <span class="org-comment-delimiter"># </span><span class="org-comment">Print the value of x</span>
x <span class="org-constant">&lt;-</span> <span class="org-highlight-numbers-number">100</span> <span class="org-comment-delimiter"># </span><span class="org-comment">Overwrite x. Note that no warning is given!</span>
x
rm(x) <span class="org-comment-delimiter"># </span><span class="org-comment">Delete x</span>
ls()
</pre>
</div>

<pre class="example">
&gt; ls() # List variables in workspace
[1] "comet" "fit"   "x"     "y"    
&gt; x # Print the value of x
[1] 10
&gt; x &lt;- 100 # Overwrite x. Note that no warning is given!
&gt; x
[1] 100
&gt; rm(x) # Delete x
&gt; ls()
[1] "comet" "fit"   "y"    
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11">Functions</h3>
<div class="outline-text-3" id="text-orgheadline11">
<p>
Using R is mostly about applying <b>functions</b> to <b>variables</b>. Functions
</p>
<ul class="org-ul">
<li>take <b>variable(s)</b> as input <b>argument(s)</b></li>
<li>perform operations</li>
<li><b>return</b> values which can be <b>assigned</b></li>
<li>optionally perform side-effects such as writing a file to disk or opening a graphics window</li>
</ul>

<p>
The general form for calling R functions is 
<code class="src src-R">FunctionName(arg.1, arg.2, ... arg.n)
</code>
</p>

<p>
Arguments can be matched by position or name
</p>

<p>
Examples:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock3"><span class="org-comment-delimiter">#</span><span class="org-comment">?sqrt</span>
a <span class="org-constant">&lt;-</span> sqrt(y) <span class="org-comment-delimiter"># </span><span class="org-comment">Call the sqrt function with argument x=y</span>
round(a, digits = <span class="org-highlight-numbers-number">2</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">Call round() with arguments x=x and digits=2</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Functions can be nested so an alternative is</span>
round(sqrt(y), digits = <span class="org-highlight-numbers-number">5</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">Take sqrt of a and round</span>
</pre>
</div>

<pre class="example">
&gt; #?sqrt
&gt; a &lt;- sqrt(y) # Call the sqrt function with argument x=y
&gt; round(a, digits = 2) # Call round() with arguments x=x and digits=2
[1] 3.32
&gt; # Functions can be nested so an alternative is
&gt; round(sqrt(y), digits = 5) # Take sqrt of a and round
[1] 3.31662
&gt;
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline13" class="outline-2">
<h2 id="orgheadline13">R packages</h2>
<div class="outline-text-2" id="text-orgheadline13">
<p>
There are thousands of R packages that extend R's capabilities.
</p>

<ul class="org-ul">
<li>To see what packages are loaded:</li>
</ul>
<p>
<code class="src src-R">search()
</code>
</p>

<ul class="org-ul">
<li>To view available packages:</li>
</ul>
<p>
<code class="src src-R"><span class="org-constant">library</span>()
</code>
</p>

<ul class="org-ul">
<li>To load a package:</li>
</ul>
<p>
<code class="src src-R"><span class="org-constant">library</span>(<span class="org-string">"car"</span>)
</code>
</p>

<ul class="org-ul">
<li>Install new package:</li>
</ul>
<p>
<code class="src src-R">install.packages(<span class="org-string">"stringdist"</span>)
</code>
</p>
</div>
</div>

<div id="outline-container-orgheadline21" class="outline-2">
<h2 id="orgheadline21">Getting data into R</h2>
<div class="outline-text-2" id="text-orgheadline21">
</div><div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14">The gss dataset</h3>
<div class="outline-text-3" id="text-orgheadline14">
<p>
The next few examples use a subset of the General Social Survey data set. The variables in this subset include those described below.
</p>
<div class="org-src-container">

<pre class="src src-org"><span class="org-org-table">| var     | description                      |</span>
<span class="org-org-table">|---------+----------------------------------|</span>
<span class="org-org-table">| marital | marital status                   |</span>
<span class="org-org-table">| age     | age of respondent                |</span>
<span class="org-org-table">| educ    | highest year of school completed |</span>
<span class="org-org-table">| sex     | respondents sex                  |</span>
<span class="org-org-table">| inc     | respondents income               |</span>
<span class="org-org-table">| happy   | general happiness                |</span>
<span class="org-org-table">| region  |                                  |</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15">The "working directory" and listing files</h3>
<div class="outline-text-3" id="text-orgheadline15">
<p>
R knows the directory it was started in, and refers to this as the "working directory". Since our workshop examples are in the Rintro folder on the desktop, we should all take a moment to set that as our working directory:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock4">setwd(<span class="org-string">"~/Desktop/Rintro"</span>)
</pre>
</div>

<p>
We can also set the working directory using paths relative to the current working directory:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock5">getwd() <span class="org-comment-delimiter"># </span><span class="org-comment">get the current working directory</span>
setwd(<span class="org-string">"dataSets"</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">set wd to the dataSets folder</span>
getwd()
setwd(<span class="org-string">".."</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">set wd to enclosing folder ("up")</span>
</pre>
</div>

<pre class="example">
&gt; getwd() # get the current working directory
[1] "/home/izahn/Documents/Work/IQSS/Classes/IQSS_Stats_Workshops/R/Rintro"
&gt; setwd("dataSets") # set wd to the dataSets folder
&gt; getwd()
[1] "/home/izahn/Documents/Work/IQSS/Classes/IQSS_Stats_Workshops/R/Rintro/dataSets"
&gt; setwd("..") # set wd to enclosing folder ("up")
&gt;
</pre>

<p>
It can be convenient to list files in a directory without leaving R
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock6">list.files(<span class="org-string">"dataSets"</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">list files in the dataSets folder</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">list.files("dataSets", pattern = ".csv") # restrict to .csv files</span>
</pre>
</div>

<pre class="example">
&gt; list.files("dataSets") # list files in the dataSets folder
[1] "gss.csv"      "gss.dta"      "gssInfo.csv"  "gss.rds"     
[5] "gss.sas7bdat" "gss.sav"      "gss.xlsx"    
&gt; # list.files("dataSets", pattern = ".csv") # restrict to .csv files  
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16">Importing data from files the easy way</h3>
<div class="outline-text-3" id="text-orgheadline16">
<p>
In order to read data from a file, you usually have to know what kind of file it is. The table below lists some common data types.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Common data types</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">comma separated (.csv)</td>
</tr>

<tr>
<td class="org-left">Stata (.dta)</td>
</tr>

<tr>
<td class="org-left">SPSS (.sav)</td>
</tr>

<tr>
<td class="org-left">SAS (.sas7bdat)</td>
</tr>

<tr>
<td class="org-left">Excel (.xls, .xlsx)</td>
</tr>
</tbody>
</table>

<p>
R is smart enough to recognize most common file formats for us using the <code>import()</code> function. To use this functionality we first need to install and attache the <code>rio</code> package.
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock7"><span class="org-comment-delimiter">## </span><span class="org-comment">install and load the rio package</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">install.packages("rio")</span>
<span class="org-constant">library</span>(rio)
<span class="org-comment-delimiter">## </span><span class="org-comment">import data from a variety of formats</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">read gss data from the gss.rds R file</span>
datGSS <span class="org-constant">&lt;-</span> import(<span class="org-string">"dataSets/gss.rds"</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">read gss data from the gss.csv comma separated file</span>
gss.data <span class="org-constant">&lt;-</span> import(<span class="org-string">"dataSets/gss.csv"</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">read a Stata dataset from gss.dta </span>
datGSS <span class="org-constant">&lt;-</span> import(<span class="org-string">"dataSets/gss.dta"</span>)
</pre>
</div>

<pre class="example">
&gt; ## install and load the rio package
&gt; # install.packages("rio")
&gt; library(rio)
&gt; ## import data from a variety of formats
&gt; # read gss data from the gss.rds R file
&gt; datGSS &lt;- import("dataSets/gss.rds")
&gt; # read gss data from the gss.csv comma separated file
&gt; gss.data &lt;- import("dataSets/gss.csv")
&gt; # read a Stata dataset from gss.dta 
&gt; datGSS &lt;- import("dataSets/gss.dta")
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17">Importing data from files the hard way</h3>
<div class="outline-text-3" id="text-orgheadline17">
<p>
In order to read data from a file, you have to know what kind of file it is. The table below lists the functions needed to import data from common file formats.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">data type</th>
<th scope="col" class="org-left">function</th>
<th scope="col" class="org-left">package</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">comma separated (.csv)</td>
<td class="org-left">read.csv()</td>
<td class="org-left">utils (default)</td>
</tr>

<tr>
<td class="org-left">other delimited formats</td>
<td class="org-left">read.table()</td>
<td class="org-left">utils (default)</td>
</tr>

<tr>
<td class="org-left">Stata version 7-12 (.dta)</td>
<td class="org-left">read.dta()</td>
<td class="org-left">foreign</td>
</tr>

<tr>
<td class="org-left">Stata version 13-14 (.dta)</td>
<td class="org-left">read<sub>dta</sub>()</td>
<td class="org-left">haven</td>
</tr>

<tr>
<td class="org-left">SPSS (.sav)</td>
<td class="org-left">read.spss()</td>
<td class="org-left">foreign</td>
</tr>

<tr>
<td class="org-left">SAS (.sas7bdat)</td>
<td class="org-left">read.sas7bdat()</td>
<td class="org-left">sas7bdat</td>
</tr>

<tr>
<td class="org-left">Excel (.xls, .xlsx)</td>
<td class="org-left">readWorksheetFromFile()</td>
<td class="org-left">XLConnect</td>
</tr>
</tbody>
</table>

<p>
Examples:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock8"><span class="org-comment-delimiter"># </span><span class="org-comment">read gss data from the gss.rds R file</span>
datGSS <span class="org-constant">&lt;-</span> readRDS(<span class="org-string">"dataSets/gss.rds"</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">read gss data from the gss.csv comma separated file</span>
gss.data <span class="org-constant">&lt;-</span> read.csv(<span class="org-string">"dataSets/gss.csv"</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">read gss data</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">read a Stata dataset from gss.dta </span>
<span class="org-constant">library</span>(foreign) <span class="org-comment-delimiter"># </span><span class="org-comment">load foreign data functions</span>
datGSS <span class="org-constant">&lt;-</span> read.dta(file=<span class="org-string">"dataSets/gss.dta"</span>)
</pre>
</div>

<pre class="example">
&gt; # read gss data from the gss.rds R file
&gt; datGSS &lt;- readRDS("dataSets/gss.rds")
&gt; # read gss data from the gss.csv comma separated file
&gt; gss.data &lt;- read.csv("dataSets/gss.csv") # read gss data
&gt; # read a Stata dataset from gss.dta 
&gt; library(foreign) # load foreign data functions
&gt; datGSS &lt;- read.dta(file="dataSets/gss.dta")
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18">Checking imported data</h3>
<div class="outline-text-3" id="text-orgheadline18">
<p>
Always a good idea  to examine the imported data set&#x2013;usually we want the results to be a <code>data.frame</code>
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock9">class(datGSS) <span class="org-comment-delimiter"># </span><span class="org-comment">check to see that test is what we expect it to be</span>
dim(datGSS) <span class="org-comment-delimiter"># </span><span class="org-comment">how many rows and columns?</span>
names(datGSS) <span class="org-comment-delimiter"># </span><span class="org-comment">or colnames(datGSS)</span>
str(datGSS[<span class="org-highlight-numbers-number">1:10</span>]) <span class="org-comment-delimiter"># </span><span class="org-comment">more details about the first 10 columns</span>
</pre>
</div>

<pre class="example">
&gt; class(datGSS) # check to see that test is what we expect it to be
[1] "data.frame"
&gt; dim(datGSS) # how many rows and columns?
[1] 1419   35
&gt; names(datGSS) # or colnames(datGSS)
 [1] "age"      "educ"     "emailhrs" "hrs1"     "sex"      "usecomp" 
 [7] "usemail"  "useweb"   "webhrs"   "hapmar"   "happy"    "speduc"  
[13] "rincome"  "income"   "marital"  "postlife" "pres96"   "richwork"
[19] "satjob"   "sibs"     "spdeg"    "spwrksta" "vote96"   "wrkstat" 
[25] "zodiac"   "incomdol" "rincdol"  "husbeduc" "wifeduc"  "husbhr"  
[31] "wifehr"   "husbft"   "wifeft"   "wkftwife" "wkfthusb"
&gt; str(datGSS[1:10]) # more details about the first 10 columns
'data.frame':	1419 obs. of  10 variables:
 $ age     : num  69 27 19 21 19 87 42 19 78 70 ...
 $ educ    : num  12 10 11 9 11 8 11 11 7 9 ...
 $ emailhrs: num  -1 -1 0 -1 50 -1 3 -1 -1 -1 ...
 $ hrs1    : num  -1 60 32 20 -1 -1 -1 -1 -1 22 ...
 $ sex     : Factor w/ 2 levels "Male","Female": 1 1 1 1 1 2 1 2 2 2 ...
 $ usecomp : Factor w/ 3 levels "No","Yes","No answer": 1 1 2 1 2 1 2 2 1 1 ...
 $ usemail : Factor w/ 3 levels "No","Yes","No answer": 1 1 1 1 2 1 2 1 1 1 ...
 $ useweb  : Factor w/ 3 levels "No","Yes","No answer": 1 1 2 1 2 1 1 1 1 1 ...
 $ webhrs  : num  -1 -1 36 -1 20 -1 0 -1 -1 -1 ...
 $ hapmar  : Factor w/ 6 levels "NAP","VERY HAPPY",..: 1 2 1 1 1 1 2 1 1 1 ...
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline19" class="outline-3">
<h3 id="orgheadline19">Saving and loading R  workspaces</h3>
<div class="outline-text-3" id="text-orgheadline19">
<p>
In addition to importing individual datasets, R can save and load entire workspaces
</p>
<ul class="org-ul">
<li>Save our entire workspace</li>
</ul>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock10">ls() <span class="org-comment-delimiter"># </span><span class="org-comment">list objects in our workspace</span>
save.image(file=<span class="org-string">"myWorkspace.RData"</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">save workspace </span>
rm(list=ls()) <span class="org-comment-delimiter"># </span><span class="org-comment">remove all objects from our workspace </span>
ls() <span class="org-comment-delimiter"># </span><span class="org-comment">list stored objects to make sure they are deleted</span>
</pre>
</div>

<pre class="example">
&gt; ls() # list objects in our workspace
[1] "a"        "comet"    "datGSS"   "fit"      "gss.data" "y"       
&gt; save.image(file="myWorkspace.RData") # save workspace 
&gt; rm(list=ls()) # remove all objects from our workspace 
&gt; ls() # list stored objects to make sure they are deleted
character(0)
&gt;
</pre>

<ul class="org-ul">
<li>Load the "myWorkspace.RData" file and check that it is restored</li>
</ul>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock11">load(<span class="org-string">"myWorkspace.RData"</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">load myWorkspace.RData</span>
ls() <span class="org-comment-delimiter"># </span><span class="org-comment">list objects</span>
</pre>
</div>

<pre class="example">
&gt; load("myWorkspace.RData") # load myWorkspace.RData
&gt; ls() # list objects
[1] "a"        "comet"    "datGSS"   "fit"      "gss.data" "y"       
&gt;
</pre>

<p>
When you close R you will be asked if you want to save your workspace &#x2013; if you choose yes then your workspace will be restored next time you start R
</p>
</div>
</div>


<div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20">Exercise 1</h3>
<div class="outline-text-3" id="text-orgheadline20">
<ol class="org-ol">
<li>Install and attach the <code>rio</code> package if you haven't already done so</li>

<li>Read the SPSS data set in dataSets/gss.sav and assign the result to an R data object named GSS.sav</li>

<li>Make sure that the data loaded in step 2 is a data.frame</li>

<li>Display the dimensions of the GSS.sav</li>

<li>BONUS: figure out how to read the Excel file "gss.xlsx" into R</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgheadline22" class="outline-2">
<h2 id="orgheadline22">Asking R for help</h2>
<div class="outline-text-2" id="text-orgheadline22">
<p>
R has extensive built-in documentation that can be accessed through R commands or through the GUI.
</p>
<ul class="org-ul">
<li>Start html help, search/browse using web browser
<ul class="org-ul">
<li>at the R console:</li>
</ul></li>
</ul>
<p>
<code class="src src-R">help.start()
</code>
</p>
<ul class="org-ul">
<li>or use the help menu from you GUI</li>
</ul>
<ul class="org-ul">
<li>Look up the documentation for a function</li>
</ul>
<p>
<code class="src src-R">help(plot)
</code>
<code class="src src-R">?kmeans
</code>
</p>
<ul class="org-ul">
<li>Look up documentation for a package</li>
</ul>
<p>
<code class="src src-R">help(package=<span class="org-string">"stats"</span>)
</code>
</p>
<ul class="org-ul">
<li>Search documentation from R (not always the best way&#x2026; google often works better)</li>
</ul>
<p>
<code class="src src-R">help.search(<span class="org-string">"classification"</span>)
</code>
</p>
</div>
</div>


<div id="outline-container-orgheadline28" class="outline-2">
<h2 id="orgheadline28">Data Manipulation</h2>
<div class="outline-text-2" id="text-orgheadline28">
</div><div id="outline-container-orgheadline23" class="outline-3">
<h3 id="orgheadline23">data.frame objects</h3>
<div class="outline-text-3" id="text-orgheadline23">
<ul class="org-ul">
<li>Usually data read into R will be stored as a <b>data.frame</b></li>

<li>A data.frame is a list of vectors of equal length
<ul class="org-ul">
<li>Each vector in the list forms a column</li>
<li>Each column can be a differnt type of vector</li>
<li>Often the columns are variables and the rows are observations</li>
</ul></li>

<li>A data.frame has two dimensions corresponding the number of rows and the number of columns (in that order)</li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline24" class="outline-3">
<h3 id="orgheadline24">Extracting subsets of data.frames</h3>
<div class="outline-text-3" id="text-orgheadline24">
<p>
You can extract subsets of data.frames using the <code>subset()</code> function<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>. Use the <code>select</code> argument to select columns:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock12"><span class="org-comment-delimiter"># </span><span class="org-comment">selecting specifig columns</span>
head(<span class="org-comment-delimiter"># </span><span class="org-comment">first n rows</span>
     subset(datGSS,            
            select = <span class="org-highlight-numbers-number">1:4</span> <span class="org-comment-delimiter"># </span><span class="org-comment">column 1 to 5</span>
            ),
     n = <span class="org-highlight-numbers-number">10</span><span class="org-comment-delimiter"># </span><span class="org-comment">show first 10 rows</span>
     )
</pre>
</div>
<p>
and the <code>subset</code> argument to select rows:
</p>
<div class="org-src-container">

<pre class="src src-R">subset(datGSS,
       <span class="org-comment-delimiter"># </span><span class="org-comment">rows where age &gt; 90</span>
       subset = age &gt; <span class="org-highlight-numbers-number">90</span>,
       <span class="org-comment-delimiter">## </span><span class="org-comment">sex and age columns</span>
       select = c(<span class="org-string">"sex"</span>, <span class="org-string">"age"</span>))

<span class="org-comment-delimiter">## </span><span class="org-comment">the $ operator can be used to extract a single column</span>
str(datGSS$age)
</pre>
</div>

<pre class="example">
&gt; subset(datGSS,
+        # rows where age &gt; 90
+        subset = age &gt; 90,
+        ## sex and age columns
+        select = c("sex", "age"))
       sex age
315 Female  99
665   Male  99
&gt; 
&gt; ## the $ operator can be used to extract a single column
&gt; str(datGSS$age)
 num [1:1419] 69 27 19 21 19 87 42 19 78 70 ...
&gt;
</pre>

<pre class="example">
&gt; # selecting specifig columns
&gt; head(# first n rows
+      subset(datGSS,            
+             select = 1:4 # column 1 to 5
+             ),
+      n = 10# show first 10 rows
+      )
   age educ emailhrs hrs1
1   69   12       -1   -1
2   27   10       -1   60
3   19   11        0   32
4   21    9       -1   20
5   19   11       50   -1
6   87    8       -1   -1
7   42   11        3   -1
8   19   11       -1   -1
9   78    7       -1   -1
10  70    9       -1   22
&gt;
</pre>

<p>
In the previous example we used <code>&gt;</code> to select rows where age was greater than 90. Other relational and logical operators are listed below.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Operator</th>
<th scope="col" class="org-left">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">==</td>
<td class="org-left">equal to</td>
</tr>

<tr>
<td class="org-left">!=</td>
<td class="org-left">not equal to</td>
</tr>

<tr>
<td class="org-left">&gt;</td>
<td class="org-left">greater than</td>
</tr>

<tr>
<td class="org-left">&gt;=</td>
<td class="org-left">greater than or equal to</td>
</tr>

<tr>
<td class="org-left">&lt;</td>
<td class="org-left">less than</td>
</tr>

<tr>
<td class="org-left">&lt;=</td>
<td class="org-left">less than or equal to</td>
</tr>

<tr>
<td class="org-left">&amp;</td>
<td class="org-left">and</td>
</tr>

<tr>
<td class="org-left">&vert;</td>
<td class="org-left">or</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-orgheadline25" class="outline-3">
<h3 id="orgheadline25">Transforming data.frames</h3>
<div class="outline-text-3" id="text-orgheadline25">
<p>
You can modify data.frames using the <code>transform()</code> function. 
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock13"><span class="org-comment-delimiter"># </span><span class="org-comment">creating new variable mean centered age</span>
datGSS <span class="org-constant">&lt;-</span> transform(datGSS,
                    ageC = age - mean(age))

 <span class="org-comment-delimiter">#</span><span class="org-comment">education difference between wifes and husbands</span>
datGSS <span class="org-constant">&lt;-</span> transform(datGSS,
                    educ.diff = wifeduc - husbeduc)

datGSS$wifeduc_comp <span class="org-constant">&lt;-</span> ifelse(
                         is.na(datGSS$wifeduc), <span class="org-comment-delimiter">#</span><span class="org-comment">condition</span>
                         mean(datGSS$wifeduc, na.rm=<span class="org-type">TRUE</span>), <span class="org-comment-delimiter"># </span><span class="org-comment">value if condition met</span>
                         datGSS$wifeduc) <span class="org-comment-delimiter"># </span><span class="org-comment">value otherwise</span>

  <span class="org-comment-delimiter">## </span><span class="org-comment">examine our newly created variables</span>
head(subset(datGSS,
            select = c(<span class="org-string">"age"</span>, <span class="org-string">"ageC"</span>, <span class="org-string">"wifeduc"</span>, <span class="org-string">"wifeduc_comp"</span>,
                       <span class="org-string">"husbeduc"</span>, <span class="org-string">"educ.diff"</span>)), n = <span class="org-highlight-numbers-number">8</span>)
</pre>
</div>

<pre class="example">
&gt; # creating new variable mean centered age
&gt; datGSS &lt;- transform(datGSS,
+                     ageC = age - mean(age))
&gt; 
&gt;  #education difference between wifes and husbands
&gt; datGSS &lt;- transform(datGSS,
+                     educ.diff = wifeduc - husbeduc)
&gt; 
&gt; datGSS$wifeduc_comp &lt;- ifelse(
+                          is.na(datGSS$wifeduc), #condition
+                          mean(datGSS$wifeduc, na.rm=TRUE), # value if condition met
+                          datGSS$wifeduc) # value otherwise
&gt; 
&gt;   ## examine our newly created variables
&gt; head(subset(datGSS,
+             select = c("age", "ageC", "wifeduc", "wifeduc_comp",
+                        "husbeduc", "educ.diff")), n = 8)
  age       ageC wifeduc wifeduc_comp husbeduc educ.diff
1  69  22.363636      NA     13.28457       NA        NA
2  27 -19.636364      13     13.00000       10         3
3  19 -27.636364      NA     13.28457       NA        NA
4  21 -25.636364      NA     13.28457       NA        NA
5  19 -27.636364      NA     13.28457       NA        NA
6  87  40.363636      NA     13.28457       NA        NA
7  42  -4.636364      10     10.00000       11        -1
8  19 -27.636364      NA     13.28457       NA        NA
&gt;
</pre>

<p>
Note that <code>transform</code> is a convenience function; see <code>?Extract</code> for a more powerful way to modify data.frames.
</p>
</div>
</div>

<div id="outline-container-orgheadline26" class="outline-3">
<h3 id="orgheadline26">Exporting Data</h3>
<div class="outline-text-3" id="text-orgheadline26">
<p>
Now that we have made some changes to our GSS data set, we might want to save those changes to a file. Everything we have done so far has only modified the data in R; the files have remained unchanged. 
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock14"><span class="org-comment-delimiter"># </span><span class="org-comment">write data to a .csv file</span>
write.csv(datGSS, file = <span class="org-string">"gss.csv"</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">write data to a Stata file</span>
write.dta(datGSS, file = <span class="org-string">"gss.dta"</span>)
<span class="org-comment-delimiter"># </span><span class="org-comment">write data to an R file</span>
saveRDS(datGSS, file = <span class="org-string">"gss.rds"</span>)
</pre>
</div>

<pre class="example">
&gt; # write data to a .csv file
&gt; write.csv(datGSS, file = "gss.csv")
&gt; # write data to a Stata file
&gt; write.dta(datGSS, file = "gss.dta")
&gt; # write data to an R file
&gt; saveRDS(datGSS, file = "gss.rds")
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27">Exercise 2: Data manipulation</h3>
<div class="outline-text-3" id="text-orgheadline27">
<p>
Use the gss.rds data set
</p>

<ol class="org-ol">
<li>Generate the following variables:
<ul class="org-ul">
<li>"rich" equal to 0 if rincdol is less than 100000, and 1 otherwise</li>
<li>"sinc" equal to incomdol - rincdol</li>
</ul></li>
<li>Create a subset of the data containing only rows where "usecomp" = "Yes"</li>
<li>Examine the data.frame created in step 2, and answer the following questions:
<ul class="org-ul">
<li>How many rows does it have?</li>
<li>How many columns does it have?</li>
<li>What is the class of the "satjob" variable?</li>
</ul></li>
<li>BONUS (hard): Generate a variable named "dual.earn" equal to 1 if both wkftwife = 1 and wkfthusb = 1, and zero otherwise</li>
</ol>
</div>
</div>
</div>



<div id="outline-container-orgheadline39" class="outline-2">
<h2 id="orgheadline39">Basic Statistics and Graphs</h2>
<div class="outline-text-2" id="text-orgheadline39">
</div><div id="outline-container-orgheadline29" class="outline-3">
<h3 id="orgheadline29">Basic statistics</h3>
<div class="outline-text-3" id="text-orgheadline29">
<p>
Descriptive statistics of single variables are straightforward:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock15">mean(datGSS$educ) <span class="org-comment-delimiter"># </span><span class="org-comment">calculate mean value of education</span>
sd(datGSS$educ) <span class="org-comment-delimiter"># </span><span class="org-comment">calculate standard deviation of x</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">calculate min, max, quantiles, mean of educ, age, and ageC</span>
summary(subset(datGSS, select = c(<span class="org-string">"educ"</span>, <span class="org-string">"age"</span>, <span class="org-string">"ageC"</span>)))
</pre>
</div>

<pre class="example">
&gt; mean(datGSS$educ) # calculate mean value of education
[1] 13.47498
&gt; sd(datGSS$educ) # calculate standard deviation of x
[1] 5.389476
&gt; # calculate min, max, quantiles, mean of educ, age, and ageC
&gt; summary(subset(datGSS, select = c("educ", "age", "ageC")))
      educ            age             ageC        
 Min.   : 0.00   Min.   :18.00   Min.   :-28.636  
 1st Qu.:12.00   1st Qu.:32.00   1st Qu.:-14.636  
 Median :13.00   Median :44.00   Median : -2.636  
 Mean   :13.47   Mean   :46.64   Mean   :  0.000  
 3rd Qu.:16.00   3rd Qu.:59.00   3rd Qu.: 12.364  
 Max.   :99.00   Max.   :99.00   Max.   : 52.364  
&gt;
</pre>


<p>
Some of these functions (e.g., summary) will also work with data.frames and other types of objects, others (such as <code>sd</code>) will not.
</p>
</div>
</div>

<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30">Counts and proportions</h3>
<div class="outline-text-3" id="text-orgheadline30">
<p>
Start by using the <code>table()</code> function to tabulate counts, then perform additional computations if needed
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock16">sex.counts <span class="org-constant">&lt;-</span> table(datGSS$sex) <span class="org-comment-delimiter"># </span><span class="org-comment">tabulate sex categories</span>
sex.counts
prop.table(sex.counts) <span class="org-comment-delimiter"># </span><span class="org-comment">convert to proportions</span>
</pre>
</div>

<pre class="example">
&gt; sex.counts &lt;- table(datGSS$sex) # tabulate sex categories
&gt; sex.counts

  Male Female 
   622    797 
&gt; prop.table(sex.counts) # convert to proportions

     Male    Female 
0.4383369 0.5616631 
&gt;
</pre>

<p>
Add variables for crosstabs
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock17">table(subset(datGSS, select = c(<span class="org-string">"sex"</span>, <span class="org-string">"happy"</span>))) <span class="org-comment-delimiter"># </span><span class="org-comment">crosstab marital X happy</span>
</pre>
</div>

<pre class="example">
&gt; table(subset(datGSS, select = c("sex", "happy"))) # crosstab marital X happy
        happy
sex      NAP VERY HAPPY PRETTY HAPPY NOT TOO HAPPY  DK  NA
  Male     0        189          350            73   0  10
  Female   0        246          447            84   1  19
&gt;
</pre>
</div>
</div>



<div id="outline-container-orgheadline31" class="outline-3">
<h3 id="orgheadline31">Statistics by classification factors</h3>
<div class="outline-text-3" id="text-orgheadline31">
<p>
The <code>by()</code> function can be used to perform a calculation separately for each level of a classifying variable
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock18">by(subset(datGSS, select = c(<span class="org-string">"income"</span>, <span class="org-string">"educ"</span>)),
   INDICES=datGSS[<span class="org-string">"sex"</span>],
   FUN=summary)
</pre>
</div>

<pre class="example">
&gt; by(subset(datGSS, select = c("income", "educ")),
+    INDICES=datGSS["sex"],
+    FUN=summary)
sex: Male
             income         educ      
 $40000 TO 49999: 59   Min.   : 4.00  
 $50000 TO 59999: 56   1st Qu.:12.00  
 $60000 TO 74999: 49   Median :13.00  
 $35000 TO 39999: 48   Mean   :13.68  
 REFUSED        : 48   3rd Qu.:16.00  
 $110000 OR OVER: 43   Max.   :99.00  
 (Other)        :319                  
---------------------------------------------------- 
sex: Female
             income         educ      
 REFUSED        : 76   Min.   : 0.00  
 $60000 TO 74999: 62   1st Qu.:12.00  
 $40000 TO 49999: 60   Median :12.00  
 $50000 TO 59999: 52   Mean   :13.32  
 $30000 TO 34999: 49   3rd Qu.:15.00  
 $25000 TO 29999: 42   Max.   :99.00  
 (Other)        :456                  
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline32" class="outline-3">
<h3 id="orgheadline32">Correlations</h3>
<div class="outline-text-3" id="text-orgheadline32">
<p>
Let's look at correlations among between age, income, and education
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock19">cor(subset(datGSS, select =  c(<span class="org-string">"age"</span>, <span class="org-string">"incomdol"</span>, <span class="org-string">"educ"</span>)))
</pre>
</div>

<pre class="example">
&gt; cor(subset(datGSS, select =  c("age", "incomdol", "educ")))
                 age   incomdol        educ
age       1.00000000 -0.1186564 -0.07362454
incomdol -0.11865641  1.0000000  0.21013267
educ     -0.07362454  0.2101327  1.00000000
&gt;
</pre>


<p>
For significance tests, use cor.test()
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock20">with(datGSS,
     cor.test(age, educ))
</pre>
</div>

<pre class="example">
&gt; with(datGSS,
+      cor.test(age, educ))

	Pearson's product-moment correlation

data:  age and educ
t = -2.779, df = 1417, p-value = 0.005525
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.12518333 -0.02166916
sample estimates:
        cor 
-0.07362454 

&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline33" class="outline-3">
<h3 id="orgheadline33">Multiple regression</h3>
<div class="outline-text-3" id="text-orgheadline33">
<p>
Modeling functions generally use the <i>formula</i> interface whith DV on left followed by "~" followed by predictors&#x2013;for details see
<code class="src src-R">help(<span class="org-string">"formula"</span>)
</code>
</p>

<ul class="org-ul">
<li>Predict the number of hours individuals spend on email (emailhrs)</li>
</ul>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock21">m1 <span class="org-constant">&lt;-</span> lm(educ ~ sex + age, data = datGSS)
summary(m1)
</pre>
</div>

<pre class="example">
&gt; m1 &lt;- lm(educ ~ sex + age, data = datGSS)
&gt; summary(m1)

Call:
lm(formula = educ ~ sex + age, data = datGSS)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.434  -1.785  -0.688   1.955  86.049 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 14.652702   0.425691  34.421  &lt; 2e-16
sexFemale   -0.275235   0.289290  -0.951  0.34156
age         -0.021938   0.008238  -2.663  0.00783

Residual standard error: 5.377 on 1416 degrees of freedom
Multiple R-squared:  0.006056,	Adjusted R-squared:  0.004652 
F-statistic: 4.314 on 2 and 1416 DF,  p-value: 0.01356

&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline34" class="outline-3">
<h3 id="orgheadline34">Save R output to a file</h3>
<div class="outline-text-3" id="text-orgheadline34">
<p>
Earlier we learned how to write a data set to a file. But what if we want to write something that isn't in a nice rectangular format, like the results of our regression model? For that we can use the <code>sink()</code> function:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock22">sink(file=<span class="org-string">"output.txt"</span>, split=<span class="org-type">TRUE</span>) <span class="org-comment-delimiter"># </span><span class="org-comment">start logging</span>
print(<span class="org-string">"This is the result from model 1\n"</span>)
print(summary(m1))
sink() <span class="org-comment-delimiter">## </span><span class="org-comment">sink with no arguments turns logging off</span>
</pre>
</div>

<pre class="example">
&gt; sink(file="output.txt", split=TRUE) # start logging
&gt; print("This is the result from model 1\n")
[1] "This is the result from model 1\n"
&gt; print(summary(m1))

Call:
lm(formula = educ ~ sex + age, data = datGSS)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.434  -1.785  -0.688   1.955  86.049 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)
(Intercept) 14.652702   0.425691  34.421  &lt; 2e-16
sexFemale   -0.275235   0.289290  -0.951  0.34156
age         -0.021938   0.008238  -2.663  0.00783

Residual standard error: 5.377 on 1416 degrees of freedom
Multiple R-squared:  0.006056,	Adjusted R-squared:  0.004652 
F-statistic: 4.314 on 2 and 1416 DF,  p-value: 0.01356

&gt; sink() ## sink with no arguments turns logging off
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline35" class="outline-3">
<h3 id="orgheadline35">Basic graphics: Frequency bars</h3>
<div class="outline-text-3" id="text-orgheadline35">
<p>
Thanks to classes and methods, you can <code>plot()</code> many  kinds of objects:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock23">plot(datGSS$marital) <span class="org-comment-delimiter"># </span><span class="org-comment">Plot a factor</span>
</pre>
</div>



<div class="figure">
<p><img src="images/examplePlot1.png" alt="examplePlot1.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orgheadline36" class="outline-3">
<h3 id="orgheadline36">Basic graphics: Boxplots by group</h3>
<div class="outline-text-3" id="text-orgheadline36">
<p>
Thanks to classes and methods, you can <code>plot()</code> many kinds of objects:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock24">with(datGSS,
     plot(marital, educ)) <span class="org-comment-delimiter"># </span><span class="org-comment">Plot ordinal by numeric</span>
</pre>
</div>


<div class="figure">
<p><img src="images/examplePlot2.png" alt="examplePlot2.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orgheadline37" class="outline-3">
<h3 id="orgheadline37">Basic graphics: Mosaic chart</h3>
<div class="outline-text-3" id="text-orgheadline37">
<p>
Thanks to classes and methods, you can <code>plot()</code> many kinds of objects:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock25">with(datGSS, <span class="org-comment-delimiter"># </span><span class="org-comment">Plot factor X factor</span>
     plot(marital, happy))
</pre>
</div>


<div class="figure">
<p><img src="images/examplePlot3.png" alt="examplePlot3.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orgheadline38" class="outline-3">
<h3 id="orgheadline38">Exercise 3</h3>
<div class="outline-text-3" id="text-orgheadline38">
<p>
Using the datGSS data.frame
</p>

<ol class="org-ol">
<li>Cross-tabulate sex and emailhrs</li>
<li>Calculate the mean and standard deviation of incomdol by sex</li>
<li>Save the results of the previous two calculations to a file</li>
<li>Create a scatter plot with educ on the x-axis and incomdol on the y-axis</li>
</ol>
</div>
</div>
</div>


<div id="outline-container-orgheadline42" class="outline-2">
<h2 id="orgheadline42">Wrap-up</h2>
<div class="outline-text-2" id="text-orgheadline42">
</div><div id="outline-container-orgheadline40" class="outline-3">
<h3 id="orgheadline40">Help us make this workshop better!</h3>
<div class="outline-text-3" id="text-orgheadline40">
<ul class="org-ul">
<li>Please take a moment to fill out a very short feedback form</li>
<li>These workshops exist for you â€“ tell us what you need!</li>
<li><a href="http://tinyurl.com/R-intro-feedback">http://tinyurl.com/R-intro-feedback</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline41" class="outline-3">
<h3 id="orgheadline41">Additional resources</h3>
<div class="outline-text-3" id="text-orgheadline41">
<ul class="org-ul">
<li>IQSS workshops: <a href="http://projects.iq.harvard.edu/rtc/filter_by/workshops">http://projects.iq.harvard.edu/rtc/filter_by/workshops</a></li>
<li>IQSS statistical consulting: <a href="http://rtc.iq.harvard.edu/">http://rtc.iq.harvard.edu/</a></li>
<li>Software (all free!):
<ul class="org-ul">
<li>R and R package download: <a href="http://cran.r-project.org/">http://cran.r-project.org/</a></li>
<li>Rstudio download: <a href="http://rstudio.org/">http://rstudio.org/</a></li>
<li>ESS (emacs R package): <a href="http://ess.r-project.org/">http://ess.r-project.org/</a></li>
</ul></li>
<li>Online tutorials
<ul class="org-ul">
<li><a href="http://www.codeschool.com/courses/try-r">http://www.codeschool.com/courses/try-r</a></li>
<li><a href="http://www.datamind.org/">http://www.datamind.org/</a></li>
</ul></li>
<li>Getting help:
<ul class="org-ul">
<li>Documentation and tutorials: <a href="http://cran.r-project.org/other-docs.html">http://cran.r-project.org/other-docs.html</a></li>
<li>Recommended R packages by topic: <a href="http://cran.r-project.org/web/views/">http://cran.r-project.org/web/views/</a></li>
<li>Mailing list: <a href="https://stat.ethz.ch/mailman/listinfo/r-help">https://stat.ethz.ch/mailman/listinfo/r-help</a></li>
<li>StackOverflow: <a href="http://stackoverflow.com/questions/tagged/r">http://stackoverflow.com/questions/tagged/r</a></li>
</ul></li>
</ul>
</div>
</div>
</div>


<div id="outline-container-orgheadline43" class="outline-2">
<h2 id="orgheadline43">Exercise solutions</h2>
<div class="outline-text-2" id="text-orgheadline43">
</div>

<div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44">Exercise 0 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline44">
<ol class="org-ol">
<li value="1">] Try to get R to add 2 plus 2.</li>
</ol>
<div class="org-src-container">

<pre class="src src-R"><span class="org-highlight-numbers-number">2</span> + <span class="org-highlight-numbers-number">2</span>
</pre>
</div>

<ol class="org-ol">
<li value="2">Try to figure out how evaluate lines directly from your R script.</li>
</ol>

<p>
<code>In Rstudo this is 'Control-Enter'; may be different in another GUI</code>
</p>

<ol class="org-ol">
<li value="3">R includes extensive documentation, including a file named "An introduction to R". Try to find this help file.</li>
</ol>

<p>
<code>Go to the main help page by running 'help.start() or using the GUI menu, find and click on the link to "An Introduction to R".</code>
</p>

<ol class="org-ol">
<li value="4">Go to <a href="http://cran.r-project.org/web/views/">http://cran.r-project.org/web/views/</a> and skim the topic closest to your field/interests.</li>
</ol>

<p>
<code>I like the machine learning topic</code>
</p>
</div>
</div>

<div id="outline-container-orgheadline45" class="outline-3">
<h3 id="orgheadline45">Exercise 1 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline45">
<ol class="org-ol">
<li value="1">Attach the <code>rio</code> package if you haven't already done so</li>
</ol>
<div class="org-src-container">

<pre class="src src-R"><span class="org-comment-delimiter">## </span><span class="org-comment">install.packages("rio")</span>
<span class="org-constant">library</span>(rio)
</pre>
</div>

<ol class="org-ol">
<li value="2">Read the SPSS data set in dataSets/gss.sav and assign the result to an R data object named GSS.sav</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">gss.data <span class="org-constant">&lt;-</span> import(<span class="org-string">"dataSets/gss.sav"</span>)
</pre>
</div>

<ol class="org-ol">
<li value="3">Make sure that the data loaded in step 2 is a data.frame (hint: check the arguments documented in the help page)</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">class(gss.data)
</pre>
</div>

<ol class="org-ol">
<li value="4">Display the dimensions of the GSS.sav.</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">dim(gss.data)
nrow(gss.data)
ncol(gss.data)
</pre>
</div>

<ol class="org-ol">
<li value="6">BONUS: figure out how to read the Excel file "gss.xlsx" into R</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">dat <span class="org-constant">&lt;-</span> import(<span class="org-string">"dataSets/gss.xlsx"</span>)
class(dat); dim(dat)
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline46" class="outline-3">
<h3 id="orgheadline46">Exercise 2 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline46">
<p>
Use the gss.rds data set
</p>
<div class="org-src-container">

<pre class="src src-R">gss <span class="org-constant">&lt;-</span> import(<span class="org-string">"dataSets/gss.rds"</span>)
</pre>
</div>

<ol class="org-ol">
<li value="1">Create a subset of the data containing only rows where "usecomp" = "Yes". How many computer users are there?</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">gss.usecomp <span class="org-constant">&lt;-</span> subset(gss, usecomp == <span class="org-string">"Yes"</span>)
nrow(gss.usecomp)
</pre>
</div>

<ol class="org-ol">
<li value="2">Generate the following variables:
<ul class="org-ul">
<li>"rich" equal to 0 if rincdol is less than 100000, and 1 otherwise</li>
<li>"sinc" equal to incomdol - rincdol</li>
</ul></li>
</ol>
<div class="org-src-container">

<pre class="src src-R">gss <span class="org-constant">&lt;-</span> transform(gss,
                 rich = ifelse(rincdol &lt; <span class="org-highlight-numbers-number">100000</span>, <span class="org-highlight-numbers-number">0</span>, <span class="org-highlight-numbers-number">1</span>),
                 sinc = incomdol - rincdol)
head(subset(gss, select = c(<span class="org-string">"rincdol"</span>, <span class="org-string">"incomdol"</span>, <span class="org-string">"rich"</span>, <span class="org-string">"sinc"</span>)))
</pre>
</div>


<ol class="org-ol">
<li value="3">Generate a variable named "dual.earn" equal to 1 if both wkftwife = 1 and wkfthusb = 1, and zero otherwise. How many dual earners are there?</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">gss$dual.earn <span class="org-constant">&lt;-</span> ifelse(gss$wkftwife == <span class="org-highlight-numbers-number">1</span> &amp; gss$wkfthusb == <span class="org-highlight-numbers-number">1</span>, <span class="org-highlight-numbers-number">1</span>, <span class="org-highlight-numbers-number">0</span>)
nrow(subset(gss, dual.earn == <span class="org-highlight-numbers-number">1</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline47" class="outline-3">
<h3 id="orgheadline47">Exercise 3 solution&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline47">
<p>
Using the datGSS data.frame
</p>

<ol class="org-ol">
<li value="1">Cross-tabulate sex and emailhrs</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">with(datGSS, table(emailhrs, sex))
</pre>
</div>

<ol class="org-ol">
<li value="2">Calculate the mean and standard deviation of incomdol by sex</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">by(datGSS$incomdol, datGSS$sex, mean)
by(datGSS$incomdol, datGSS$sex, sd)
</pre>
</div>

<ol class="org-ol">
<li value="3">Create a scatter plot with educ on the x-axis and incomdol on the y-axis</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">plot(subset(datGSS, select = c(<span class="org-string">"educ"</span>, <span class="org-string">"incomdol"</span>)))
</pre>
</div>

<p>
<code>That first attempt is pretty ugly, let's clean it up.</code>
</p>
<div class="org-src-container">

<pre class="src src-R">plot(log(incomdol) ~ jitter(educ, <span class="org-highlight-numbers-number">8</span>), <span class="org-comment-delimiter"># </span><span class="org-comment">formula interface with log an jitter</span>
     data = subset(datGSS, <span class="org-comment-delimiter"># </span><span class="org-comment">subsetting data as part of the plot call</span>
                   subset = educ &lt; <span class="org-highlight-numbers-number">97</span>),
     cex = .6 <span class="org-comment-delimiter"># </span><span class="org-comment">make points smaller</span>
     )
</pre>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
Note that <code>subset()</code> is a convenience function; see <code>?Extract</code> for a more powerful (and complicated) way to subset data.
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p><a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'><img alt='Creative Commons License' style='border-width:0' src='https://i.creativecommons.org/l/by-sa/4.0/80x15.png' /></a><span xmlns:dct='http://purl.org/dc/terms/' property='dct:title'> These statistical software workshop materials</span> by <a xmlns:cc='http://creativecommons.org/ns#' href='http://rtc.iq.harvard.edu' property='cc:attributionName' rel='cc:attributionURL'>Harvard University</a> are licensed under a <a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'>Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p> <p> Presented by <a href='http://rtc.iq.harvard.edu'>Research Technology Consulting</a> at <br></br> <a href='http://iq.harvard.edu'><img style='margin-left: auto; margin-right: auto;' alt='The Institute for Quantitative Social Science' title='IQSS logo' src='http://static.projects.iq.harvard.edu/files/styles/os_files_small/public/rtc/files/iqsslogo-2014_0.png'></img></a></p>
</div>
</body>
</html>