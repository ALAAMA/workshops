<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2015-09-22 Tue 16:20 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="viewport" content="width=device-width, initial-scale=1" />
<title>Introduction To Programming In R</title>
<meta  name="generator" content="Org-mode" />
<link rel="stylesheet" type="text/css" href="http://tutorials.iq.harvard.edu/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://tutorials.iq.harvard.edu/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Introduction To Programming In R</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline4">Workshop overview and materials</a>
<ul>
<li><a href="#orgheadline1">Workshop description</a></li>
<li><a href="#orgheadline2">Materials and setup</a></li>
<li><a href="#orgheadline3">Example project overview</a></li>
</ul>
</li>
<li><a href="#orgheadline5">I want all the data</a>
<ul>
<li><a href="#orgheadline6">Searching text with regular expressions</a></li>
<li><a href="#orgheadline7">Packages for reading and manipulating html</a></li>
<li><a href="#orgheadline8">Getting the list of data links the easy way</a></li>
<li><a href="#orgheadline9">Vector types</a></li>
<li><a href="#orgheadline10">Vector attributes</a></li>
<li><a href="#orgheadline11">Factor vectors</a></li>
<li><a href="#orgheadline12">Lists and data.frames</a></li>
<li><a href="#orgheadline13">Data types summary</a></li>
<li><a href="#orgheadline14">Exercise 0</a></li>
</ul>
</li>
<li><a href="#orgheadline22">Extracting and replacing object elements</a>
<ul>
<li><a href="#orgheadline15">Indexing by position or name</a></li>
<li><a href="#orgheadline16">Logical indexing</a></li>
<li><a href="#orgheadline17">Indexing matrices</a></li>
<li><a href="#orgheadline18">Indexing lists</a></li>
<li><a href="#orgheadline19">Indexing data.frames</a></li>
<li><a href="#orgheadline20">Extraction/replacement summary</a></li>
<li><a href="#orgheadline21">Exercise 1</a></li>
</ul>
</li>
<li><a href="#orgheadline23">Looping and applying</a>
<ul>
<li><a href="#orgheadline24">The apply function</a></li>
<li><a href="#orgheadline25">for loops</a></li>
<li><a href="#orgheadline26">The sapply function</a></li>
<li><a href="#orgheadline27">Combining sapply and indexing</a></li>
<li><a href="#orgheadline28">Applying functions summary</a></li>
</ul>
</li>
<li><a href="#orgheadline35">Writing functions</a>
<ul>
<li><a href="#orgheadline29">Functions</a></li>
<li><a href="#orgheadline30">Function return value</a></li>
<li><a href="#orgheadline31">Writing functions example</a></li>
<li><a href="#orgheadline32">Debugging basics</a></li>
<li><a href="#orgheadline33">Writing functions summary</a></li>
<li><a href="#orgheadline34">Exercise 2</a></li>
</ul>
</li>
<li><a href="#orgheadline42">Control flow</a>
<ul>
<li><a href="#orgheadline36">Control flow</a></li>
<li><a href="#orgheadline37">Control flow examples</a></li>
<li><a href="#orgheadline38">Control flow examples</a></li>
<li><a href="#orgheadline39">Control flow examples</a></li>
<li><a href="#orgheadline40">Control flow summary</a></li>
<li><a href="#orgheadline41">Exercise 3</a></li>
</ul>
</li>
<li><a href="#orgheadline50">The S3 object class system</a>
<ul>
<li><a href="#orgheadline43">The S3 object class system</a></li>
<li><a href="#orgheadline44">Object class</a></li>
<li><a href="#orgheadline45">Function methods</a></li>
<li><a href="#orgheadline46">Creating new function methods</a></li>
<li><a href="#orgheadline47">Creating generic functions</a></li>
<li><a href="#orgheadline48">S3 classes summary</a></li>
<li><a href="#orgheadline49">Exercise 4</a></li>
</ul>
</li>
<li><a href="#orgheadline57">Things that may surprise you</a>
<ul>
<li><a href="#orgheadline51">Gotcha's</a></li>
<li><a href="#orgheadline52">Floating point comparison</a></li>
<li><a href="#orgheadline53">Missing values</a></li>
<li><a href="#orgheadline54">Automatic type conversion</a></li>
<li><a href="#orgheadline55">Optional argument inconsistencies</a></li>
<li><a href="#orgheadline56">Trouble with Factors</a></li>
</ul>
</li>
<li><a href="#orgheadline64">Exercise solutions</a>
<ul>
<li><a href="#orgheadline58">Exercise 0 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline59">Exercise 0</a></li>
<li><a href="#orgheadline60">Exercise 1 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline61">Exercise 2 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline62">Exercise 3 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
<li><a href="#orgheadline63">Exercise 4 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></a></li>
</ul>
</li>
<li><a href="#orgheadline67">Additional resources</a>
<ul>
<li><a href="#orgheadline65">Additional reading and resources</a></li>
<li><a href="#orgheadline66">Feedback</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4">Workshop overview and materials</h2>
<div class="outline-text-2" id="text-orgheadline4">
</div><div id="outline-container-orgheadline1" class="outline-3">
<h3 id="orgheadline1">Workshop description</h3>
<div class="outline-text-3" id="text-orgheadline1">
<p>
This is an intermediate/advanced R course appropriate for those with basic knowledge of R. It is intended for those already comfortable with using R for data analysis who wish to move on to writing their own functions. To the extent possible this workshop uses real-world examples. That is to say that concepts are introduced as they are needed for a realistic analysis task. 
</p>

<p>
Prerequisite: basic familiarity with R, such as acquired from an introductory R workshop.
</p>

<ul class="org-ul">
<li>Learning objectives:
<ul class="org-ul">
<li>Index data objects by position, name or logical condition</li>
<li>Understand looping and branching</li>
<li>Write your own simple functions</li>
<li>Debug functions</li>
<li>Understand and use the S3 object system</li>
</ul></li>
</ul>

<p>
This workshop is free for Harvard and MIT affiliates. <a href="http://projects.iq.harvard.edu/rtc/workshop-registration">Click here to sign up!</a>
</p>

<ul class="org-ul">
<li>Instructor - <a href="http://projects.iq.harvard.edu/rtc/people/ista-zahn">Ista Zahn</a></li>
<li>Location - Rm K018, 1737 Cambridge St (CGIS Knafel Building)</li>
</ul>

<p>
For further details and registration information, please contact us at <a href="mailto:dataclass@help.hmdc.harvard.edu">dataclass@help.hmdc.harvard.edu</a>
</p>
</div>
</div>

<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2">Materials and setup</h3>
<div class="outline-text-3" id="text-orgheadline2">
<p>
Everyone should have R installed &#x2013; if not:
</p>

<ul class="org-ul">
<li>Open a web browser and go to <a href="http://cran.r-project.org/">http://cran.r-project.org/</a> and download and install it</li>
<li>Also helpful to install RStudio (download from <a href="http://rstudio.com/">http://rstudio.com/</a>)</li>
</ul>

<p>
Materials for this workshop include slides, example data sets, and example code.
</p>

<ul class="org-ul">
<li>Download materials from <a href="http://tutorials.iq.harvard.edu/R/RProgramming.zip">http://tutorials.iq.harvard.edu/R/RProgramming.zip</a></li>
<li>Extract the zip file containing the materials to your desktop</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3">Example project overview</h3>
<div class="outline-text-3" id="text-orgheadline3">
<p>
Throughout this workshop we will return to a running example that involves acquiring, processing, and analyzing data from the <a href="http://www.census.gov/cps/">Current Population Survey</a> (CPS). In this context we will learn about finding and using R packages, importing and manipulating data, writing functions, and more.
</p>
</div>
</div>
</div>

<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5">I want all the data</h2>
<div class="outline-text-2" id="text-orgheadline5">
<p>
It is common for data to be made available on a website somewhere, either by a government agency, research group, or other organizations and entities. Often the data you want is spread over many files, and retrieving it all one file at a time is tedious and time consuming. Such is the case with the CPS data we will be using today.
</p>

<p>
The Center for Economic and Policy Research has helpfully <a href="http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/">compiled CPS data going back to 1979</a><sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>, one file per year. Although we could open a web browser and download these files one at a time, it will be faster and easier to instruct R to do that for us. Doing it this way will also give us an excuse to talk about regular expressions, package management, and other useful techniques.
</p>

<p>
Our goal is to download all the Stata data sets from <a href="http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/">http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/</a>. In order to do that we need a list of the Uniform Resource Locators (URLs) of those files. The URLs we need are right there as links in the ceprdata.org webpage. All we have to do is read that data in a way R can understand. 
</p>
</div>


<div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6">Searching text with regular expressions</h3>
<div class="outline-text-3" id="text-orgheadline6">
<p>
Although some will say you should never ever attempt to extract information from html using regular expressions<sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>, it does work OK for simple tasks. The fist step is to read the html into R. We can do that using the <code>readLines</code> function, like this:
</p>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">Read html page from ceprdata.org into R. Each line will be stored as </span>
<span style="color: #2aa198;">## </span><span style="color: #2aa198;">an element in a vector of lines.</span>
ceprHtmlIndex <span style="color: #a45bad;">&lt;-</span> readLines<span style="color: #2f96dc;">(</span>
<span style="color: #2d9574;">"http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/"</span>
<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; ceprHtmlIndex &lt;- readLines(
+ "http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/"
+ )
&gt;
</pre>

<p>
OK, what are we working with?
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">how many lines do we have?</span>
length<span style="color: #2f96dc;">(</span>ceprHtmlIndex<span style="color: #2f96dc;">)</span>
<span style="color: #2aa198;">## </span><span style="color: #2aa198;">what do the first few lines look like?</span>
head<span style="color: #2f96dc;">(</span>ceprHtmlIndex, 10<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;">## </span><span style="color: #2aa198;">look at the first few lines of html</span>
</pre>
</div>

<pre class="example">
&gt; ## how many lines do we have?
&gt; length(ceprHtmlIndex)
[1] 295
&gt; ## what do the first few lines look like?
&gt; head(ceprHtmlIndex, 10) ## look at the first 15 lines of html
 [1] "&lt;!doctype html&gt;"                                                               
 [2] "&lt;!--[if lt IE 7]&gt; &lt;html class=\"no-js ie6 oldie\" lang=\"en-US\"&gt; &lt;![endif]--&gt;"
 [3] "&lt;!--[if IE 7]&gt;    &lt;html class=\"no-js ie7 oldie\" lang=\"en-US\"&gt; &lt;![endif]--&gt;"
 [4] "&lt;!--[if IE 8]&gt;    &lt;html class=\"no-js ie8 oldie\" lang=\"en-US\"&gt; &lt;![endif]--&gt;"
 [5] "&lt;!--[if gt IE 8]&gt;&lt;!--&gt; &lt;html class=\"no-js\" lang=\"en-US\"&gt; &lt;!--&lt;![endif]--&gt;" 
 [6] "&lt;head&gt;"                                                                        
 [7] "\t&lt;meta charset=\"UTF-8\" /&gt;"                                                  
 [8] ""                                                                              
 [9] "\t&lt;title&gt;CPS ORG Data &amp;#8211; ceprDATA&lt;/title&gt;"                                
[10] ""                                                                              
&gt;
</pre>
<p>
In html links are specified using the <code>&lt;a&gt;</code> (for <i>anchor</i>) tag. So now we want to search through our html and find lines that include an <code>a</code> tag. In R we can search for strings using the <code>grep</code> function.
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">find lines with links (a tags)</span>
<span style="color: #2f96dc;">(</span>aLineNumbers <span style="color: #a45bad;">&lt;-</span> grep<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"&lt;a"</span>, ceprHtmlIndex<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">line numbers containing &lt;a&gt; tags</span>
head<span style="color: #2f96dc;">(</span>aLines <span style="color: #a45bad;">&lt;-</span> grep<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"&lt;a"</span>, ceprHtmlIndex, value = <span style="color: #38a882; font-weight: bold;">TRUE</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">lines containing &lt;a&gt; tags</span>
</pre>
</div>

<pre class="example">
&gt; ## find lines with links (a tags)
&gt; (aLineNumbers &lt;- grep("&lt;a", ceprHtmlIndex)) # line numbers containing &lt;a&gt; tags
 [1] 141 143 149 150 151 152 153 154 155 156 167 169 173 175 176 177
[17] 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193
[33] 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209
[49] 210 212 219 223 225 226 227 228 231 233 234 235 236 239 241 242
[65] 243 244 247 249 250 251 252 255 257 258 259 260 263 264 265 267
[81] 269 271 273 282 285 289
&gt; head(aLines &lt;- grep("&lt;a", ceprHtmlIndex, value = TRUE)) # lines containing &lt;a&gt; tags
[1] "\t\t\t\t\t\t\t\t\t&lt;h1 id=\"site-name\"&gt;&lt;a href=\"http://ceprdata.org/\" title=\"Home\" rel=\"home\"&gt;&lt;img src=\"http://s403740266.onlinehome.us/wp-content/uploads/2012/03/ceprdata_logo.png\"&gt;&lt;/a&gt;&lt;/h1&gt;"
[2] "\t\t\t\t&lt;ul class=\"nav\"&gt;&lt;li class=\"menu-item menu-item-type-taxonomy menu-item-object-category\"&gt;&lt;a href=\"http://ceprdata.org/wp-login.php\"&gt;Log in&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;\t\t\t\t&lt;/nav&gt;"                    
[3] "\t\t\t\t&lt;ul id=\"menu-top-menu\" class=\"nav\"&gt;&lt;li id=\"menu-item-9\" class=\"menu-item menu-item-type-custom menu-item-object-custom menu-item-9\"&gt;&lt;a href=\"http://www.ceprdata.org\"&gt;Home&lt;/a&gt;&lt;/li&gt;"  
[4] "&lt;li id=\"menu-item-8\" class=\"menu-item menu-item-type-post_type menu-item-object-page current-page-ancestor menu-item-8\"&gt;&lt;a href=\"http://ceprdata.org/cps-uniform-data-extracts/\"&gt;CPS&lt;/a&gt;&lt;/li&gt;"    
[5] "&lt;li id=\"menu-item-13\" class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-13\"&gt;&lt;a href=\"http://ceprdata.org/sipp-uniform-data-extracts/\"&gt;SIPP&lt;/a&gt;&lt;/li&gt;"                      
[6] "&lt;li id=\"menu-item-108\" class=\"menu-item menu-item-type-post_type menu-item-object-page menu-item-108\"&gt;&lt;a href=\"http://ceprdata.org/acs-uniform-data-extracts/\"&gt;ACS&lt;/a&gt;&lt;/li&gt;"                      
&gt;
</pre>

<p>
So far we've successfully matched all lines containing the string "&lt;a". Our actual target is a bit more specific. If we inspect the elements we want to match using our web browser we'll see something like this:<img src="images/inspectHtml.png" alt="inspectHtml.png" /> 
</p>

<div class="org-src-container">

<pre class="src src-HTML">&lt;a onclick="_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2011']);" href="/wp-content/cps/data/cepr_org_2014.zip"&gt;cepr_org_2014.zip&lt;/a&gt;
</pre>
</div>
<p>
This tells us that we want to match lines containing an "&lt;a" followed (eventually) by ".zip". In order to perform this more sophisticated search we need to use <i>regular expressions</i>. In regular expressions the <code>.</code> matches any character (except new lines) and the <code>*</code> repeats the previous character zero or more times. So <code>&lt;a.*\\.zip</code> means "find <code>&lt;a</code> followed by any character repeated any number of times followed by <code>.zip</code>". Note that in <code>\\.</code> the backslashes escape the dot so that it is matched literally rather than matching any character. Let's try it out!
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">find lines with &lt;a&gt; tags refering to zip files</span>
<span style="color: #2f96dc;">(</span>dataLines <span style="color: #a45bad;">&lt;-</span> grep<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"&lt;a.*\\.zip"</span>, ceprHtmlIndex, value = <span style="color: #38a882; font-weight: bold;">TRUE</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; ## find lines with &lt;a&gt; tags refering to zip files
&gt; (dataLines &lt;- grep("&lt;a.*\\.zip", ceprHtmlIndex, value = TRUE))
 [1] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2011']);\" href=\"/wp-content/cps/data/cepr_org_2014.zip\"&gt;cepr_org_2014.zip&lt;/a&gt;&lt;/li&gt;"
 [2] "&lt;li&gt;&lt;a href=\"/wp-content/cps/data/cepr_org_2013.zip\"&gt;cepr_org_2013.zip&lt;/a&gt;&lt;/li&gt;"                                                                            
 [3] "&lt;li&gt;&lt;a href=\"/wp-content/cps/data/cepr_org_2012.zip\"&gt;cepr_org_2012.zip&lt;/a&gt;&lt;/li&gt;"                                                                            
 [4] "&lt;li&gt;&lt;a href=\"/wp-content/cps/data/cepr_org_2011.zip\"&gt;cepr_org_2011.zip&lt;/a&gt;&lt;/li&gt;"                                                                            
 [5] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2010']);\" href=\"/wp-content/cps/data/cepr_org_2010.zip\"&gt;cepr_org_2010.zip&lt;/a&gt;&lt;/li&gt;"
 [6] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2009']);\" href=\"/wp-content/cps/data/cepr_org_2009.zip\"&gt;cepr_org_2009.zip&lt;/a&gt;&lt;/li&gt;"
 [7] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2008']);\" href=\"/wp-content/cps/data/cepr_org_2008.zip\"&gt;cepr_org_2008.zip&lt;/a&gt;&lt;/li&gt;"
 [8] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2007']);\" href=\"/wp-content/cps/data/cepr_org_2007.zip\"&gt;cepr_org_2007.zip&lt;/a&gt;&lt;/li&gt;"
 [9] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2006']);\" href=\"/wp-content/cps/data/cepr_org_2006.zip\"&gt;cepr_org_2006.zip&lt;/a&gt;&lt;/li&gt;"
[10] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2005']);\" href=\"/wp-content/cps/data/cepr_org_2005.zip\"&gt;cepr_org_2005.zip&lt;/a&gt;&lt;/li&gt;"
[11] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2004']);\" href=\"/wp-content/cps/data/cepr_org_2004.zip\"&gt;cepr_org_2004.zip&lt;/a&gt;&lt;/li&gt;"
[12] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2003']);\" href=\"/wp-content/cps/data/cepr_org_2003.zip\"&gt;cepr_org_2003.zip&lt;/a&gt;&lt;/li&gt;"
[13] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2002']);\" href=\"/wp-content/cps/data/cepr_org_2002.zip\"&gt;cepr_org_2002.zip&lt;/a&gt;&lt;/li&gt;"
[14] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2001']);\" href=\"/wp-content/cps/data/cepr_org_2001.zip\"&gt;cepr_org_2001.zip&lt;/a&gt;&lt;/li&gt;"
[15] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_2000']);\" href=\"/wp-content/cps/data/cepr_org_2000.zip\"&gt;cepr_org_2000.zip&lt;/a&gt;&lt;/li&gt;"
[16] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1999']);\" href=\"/wp-content/cps/data/cepr_org_1999.zip\"&gt;cepr_org_1999.zip&lt;/a&gt;&lt;/li&gt;"
[17] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1998']);\" href=\"/wp-content/cps/data/cepr_org_1998.zip\"&gt;cepr_org_1998.zip&lt;/a&gt;&lt;/li&gt;"
[18] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1997']);\" href=\"/wp-content/cps/data/cepr_org_1997.zip\"&gt;cepr_org_1997.zip&lt;/a&gt;&lt;/li&gt;"
[19] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1996']);\" href=\"/wp-content/cps/data/cepr_org_1996.zip\"&gt;cepr_org_1996.zip&lt;/a&gt;&lt;/li&gt;"
[20] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1995']);\" href=\"/wp-content/cps/data/cepr_org_1995.zip\"&gt;cepr_org_1995.zip&lt;/a&gt;&lt;/li&gt;"
[21] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1994']);\" href=\"/wp-content/cps/data/cepr_org_1994.zip\"&gt;cepr_org_1994.zip&lt;/a&gt;&lt;/li&gt;"
[22] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1993']);\" href=\"/wp-content/cps/data/cepr_org_1993.zip\"&gt;cepr_org_1993.zip&lt;/a&gt;&lt;/li&gt;"
[23] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1992']);\" href=\"/wp-content/cps/data/cepr_org_1992.zip\"&gt;cepr_org_1992.zip&lt;/a&gt;&lt;/li&gt;"
[24] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1991']);\" href=\"/wp-content/cps/data/cepr_org_1991.zip\"&gt;cepr_org_1991.zip&lt;/a&gt;&lt;/li&gt;"
[25] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1990']);\" href=\"/wp-content/cps/data/cepr_org_1990.zip\"&gt;cepr_org_1990.zip&lt;/a&gt;&lt;/li&gt;"
[26] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1989']);\" href=\"/wp-content/cps/data/cepr_org_1989.zip\"&gt;cepr_org_1989.zip&lt;/a&gt;&lt;/li&gt;"
[27] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1988']);\" href=\"/wp-content/cps/data/cepr_org_1988.zip\"&gt;cepr_org_1988.zip&lt;/a&gt;&lt;/li&gt;"
[28] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1987']);\" href=\"/wp-content/cps/data/cepr_org_1987.zip\"&gt;cepr_org_1987.zip&lt;/a&gt;&lt;/li&gt;"
[29] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1986']);\" href=\"/wp-content/cps/data/cepr_org_1986.zip\"&gt;cepr_org_1986.zip&lt;/a&gt;&lt;/li&gt;"
[30] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1985']);\" href=\"/wp-content/cps/data/cepr_org_1985.zip\"&gt;cepr_org_1985.zip&lt;/a&gt;&lt;/li&gt;"
[31] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1984']);\" href=\"/wp-content/cps/data/cepr_org_1984.zip\"&gt;cepr_org_1984.zip&lt;/a&gt;&lt;/li&gt;"
[32] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1983']);\" href=\"/wp-content/cps/data/cepr_org_1983.zip\"&gt;cepr_org_1983.zip&lt;/a&gt;&lt;/li&gt;"
[33] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1982']);\" href=\"/wp-content/cps/data/cepr_org_1982.zip\"&gt;cepr_org_1982.zip&lt;/a&gt;&lt;/li&gt;"
[34] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1981']);\" href=\"/wp-content/cps/data/cepr_org_1981.zip\"&gt;cepr_org_1981.zip&lt;/a&gt;&lt;/li&gt;"
[35] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1980']);\" href=\"/wp-content/cps/data/cepr_org_1980.zip\"&gt;cepr_org_1980.zip&lt;/a&gt;&lt;/li&gt;"
[36] "&lt;li&gt;&lt;a onclick=\"_gaq.push(['_trackEvent', 'File','Download', 'cepr_org_1979']);\" href=\"/wp-content/cps/data/cepr_org_1979.zip\"&gt;cepr_org_1979.zip&lt;/a&gt;&lt;/li&gt;"
&gt;
</pre>
<p>
We're getting close! We have identified the lines containing the information we need. Now we just need to extract the text following the <code>href</code> argument. For that we need to use another feature of regular expressions called <i>capture groups</i> and <i>back references</i>. Here's how it works:
</p>
<div class="org-src-container">

<pre class="src src-R"><span style="color: #2f96dc;">(</span>dataURLs <span style="color: #a45bad;">&lt;-</span> gsub<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"^.*href=\"(.*\\.zip)\".*$"</span>, <span style="color: #2d9574;">"\\1"</span>, dataLines<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; (dataURLs &lt;- gsub("^.*href=\"(.*\\.zip)\".*$", "\\1", dataLines))
 [1] "/wp-content/cps/data/cepr_org_2014.zip"
 [2] "/wp-content/cps/data/cepr_org_2013.zip"
 [3] "/wp-content/cps/data/cepr_org_2012.zip"
 [4] "/wp-content/cps/data/cepr_org_2011.zip"
 [5] "/wp-content/cps/data/cepr_org_2010.zip"
 [6] "/wp-content/cps/data/cepr_org_2009.zip"
 [7] "/wp-content/cps/data/cepr_org_2008.zip"
 [8] "/wp-content/cps/data/cepr_org_2007.zip"
 [9] "/wp-content/cps/data/cepr_org_2006.zip"
[10] "/wp-content/cps/data/cepr_org_2005.zip"
[11] "/wp-content/cps/data/cepr_org_2004.zip"
[12] "/wp-content/cps/data/cepr_org_2003.zip"
[13] "/wp-content/cps/data/cepr_org_2002.zip"
[14] "/wp-content/cps/data/cepr_org_2001.zip"
[15] "/wp-content/cps/data/cepr_org_2000.zip"
[16] "/wp-content/cps/data/cepr_org_1999.zip"
[17] "/wp-content/cps/data/cepr_org_1998.zip"
[18] "/wp-content/cps/data/cepr_org_1997.zip"
[19] "/wp-content/cps/data/cepr_org_1996.zip"
[20] "/wp-content/cps/data/cepr_org_1995.zip"
[21] "/wp-content/cps/data/cepr_org_1994.zip"
[22] "/wp-content/cps/data/cepr_org_1993.zip"
[23] "/wp-content/cps/data/cepr_org_1992.zip"
[24] "/wp-content/cps/data/cepr_org_1991.zip"
[25] "/wp-content/cps/data/cepr_org_1990.zip"
[26] "/wp-content/cps/data/cepr_org_1989.zip"
[27] "/wp-content/cps/data/cepr_org_1988.zip"
[28] "/wp-content/cps/data/cepr_org_1987.zip"
[29] "/wp-content/cps/data/cepr_org_1986.zip"
[30] "/wp-content/cps/data/cepr_org_1985.zip"
[31] "/wp-content/cps/data/cepr_org_1984.zip"
[32] "/wp-content/cps/data/cepr_org_1983.zip"
[33] "/wp-content/cps/data/cepr_org_1982.zip"
[34] "/wp-content/cps/data/cepr_org_1981.zip"
[35] "/wp-content/cps/data/cepr_org_1980.zip"
[36] "/wp-content/cps/data/cepr_org_1979.zip"
&gt;
</pre>

<p>
Great, we've matched all the data file links. The next step is to iterate over these links and download the data. But before we get there, let's look at a couple of alternative methods we could use to get the list of data file links.
</p>
</div>
</div>

<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7">Packages for reading and manipulating html</h3>
<div class="outline-text-3" id="text-orgheadline7">
<p>
In the previous section we extracted data file links from an html page using regular expressions. An alternative is to use a package dedicated to parsing XML and HTML. How do we find such a package?
</p>
<dl class="org-dl">
<dt>Task views</dt><dd><a href="https://cran.r-project.org/web/views/WebTechnologies.html">https://cran.r-project.org/web/views/WebTechnologies.html</a></dd>
<dt>R package search</dt><dd><a href="http://www.r-pkg.org/search.html?q=html+xml">http://www.r-pkg.org/search.html?q=html+xml</a></dd>
<dt>Web search</dt><dd><a href="https://www.google.com/search?q=R+parse+html+xml&amp;ie=utf-8&amp;oe=utf-8">https://www.google.com/search?q=R+parse+html+xml&ie=utf-8&oe=utf-8</a></dd>
</dl>

<p>
For parsing html in R I recommend either the <code>httr</code> package or the <code>rvest</code> package, with the former being more flexible and the later being more user friendly. Let's use the friendlier one.
</p>

<div class="org-src-container">

<pre class="src src-R">  <span style="color: #2aa198;">## </span><span style="color: #2aa198;">install.packages("rvest")</span>
  <span style="color: #a45bad;">library</span><span style="color: #2f96dc;">(</span>rvest<span style="color: #2f96dc;">)</span>
  dataPage <span style="color: #a45bad;">&lt;-</span> html<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/"</span><span style="color: #2f96dc;">)</span>

  <span style="color: #2aa198;">## </span><span style="color: #2aa198;">find the link ("a") elemets extract the link ("href") attributes</span>
  allLinks <span style="color: #a45bad;">&lt;-</span> html_attr<span style="color: #2f96dc;">(</span>html_nodes<span style="color: #bc6ec5;">(</span>dataPage, <span style="color: #2d9574;">"a"</span><span style="color: #bc6ec5;">)</span>, <span style="color: #2d9574;">"href"</span><span style="color: #2f96dc;">)</span>
  dataLinks <span style="color: #a45bad;">&lt;-</span> paste0<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"http://ceprdata.org"</span>,
                      grep<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"^/wp-content/cps/data/.*\\.zip$"</span>,
                           allLinks,
                           value = <span style="color: #38a882; font-weight: bold;">TRUE</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
dataLinks
</pre>
</div>

<pre class="example">
&gt;   ## install.packages("rvest")
&gt;   library(rvest)
&gt;   dataPage &lt;- html("http://ceprdata.org/cps-uniform-data-extracts/cps-outgoing-rotation-group/cps-org-data/")
&gt; 
&gt;   ## find the link ("a") elemets extract the link ("href") attributes
&gt;   allLinks &lt;- html_attr(html_nodes(dataPage, "a"), "href")
&gt;   dataLinks &lt;- paste0("http://ceprdata.org",
+                       grep("^/wp-content/cps/data/.*\\.zip$",
+                            allLinks,
+                            value = TRUE))
&gt; dataLinks
 [1] "http://ceprdata.org/wp-content/cps/data/cepr_org_2014.zip"
 [2] "http://ceprdata.org/wp-content/cps/data/cepr_org_2013.zip"
 [3] "http://ceprdata.org/wp-content/cps/data/cepr_org_2012.zip"
 [4] "http://ceprdata.org/wp-content/cps/data/cepr_org_2011.zip"
 [5] "http://ceprdata.org/wp-content/cps/data/cepr_org_2010.zip"
 [6] "http://ceprdata.org/wp-content/cps/data/cepr_org_2009.zip"
 [7] "http://ceprdata.org/wp-content/cps/data/cepr_org_2008.zip"
 [8] "http://ceprdata.org/wp-content/cps/data/cepr_org_2007.zip"
 [9] "http://ceprdata.org/wp-content/cps/data/cepr_org_2006.zip"
[10] "http://ceprdata.org/wp-content/cps/data/cepr_org_2005.zip"
[11] "http://ceprdata.org/wp-content/cps/data/cepr_org_2004.zip"
[12] "http://ceprdata.org/wp-content/cps/data/cepr_org_2003.zip"
[13] "http://ceprdata.org/wp-content/cps/data/cepr_org_2002.zip"
[14] "http://ceprdata.org/wp-content/cps/data/cepr_org_2001.zip"
[15] "http://ceprdata.org/wp-content/cps/data/cepr_org_2000.zip"
[16] "http://ceprdata.org/wp-content/cps/data/cepr_org_1999.zip"
[17] "http://ceprdata.org/wp-content/cps/data/cepr_org_1998.zip"
[18] "http://ceprdata.org/wp-content/cps/data/cepr_org_1997.zip"
[19] "http://ceprdata.org/wp-content/cps/data/cepr_org_1996.zip"
[20] "http://ceprdata.org/wp-content/cps/data/cepr_org_1995.zip"
[21] "http://ceprdata.org/wp-content/cps/data/cepr_org_1994.zip"
[22] "http://ceprdata.org/wp-content/cps/data/cepr_org_1993.zip"
[23] "http://ceprdata.org/wp-content/cps/data/cepr_org_1992.zip"
[24] "http://ceprdata.org/wp-content/cps/data/cepr_org_1991.zip"
[25] "http://ceprdata.org/wp-content/cps/data/cepr_org_1990.zip"
[26] "http://ceprdata.org/wp-content/cps/data/cepr_org_1989.zip"
[27] "http://ceprdata.org/wp-content/cps/data/cepr_org_1988.zip"
[28] "http://ceprdata.org/wp-content/cps/data/cepr_org_1987.zip"
[29] "http://ceprdata.org/wp-content/cps/data/cepr_org_1986.zip"
[30] "http://ceprdata.org/wp-content/cps/data/cepr_org_1985.zip"
[31] "http://ceprdata.org/wp-content/cps/data/cepr_org_1984.zip"
[32] "http://ceprdata.org/wp-content/cps/data/cepr_org_1983.zip"
[33] "http://ceprdata.org/wp-content/cps/data/cepr_org_1982.zip"
[34] "http://ceprdata.org/wp-content/cps/data/cepr_org_1981.zip"
[35] "http://ceprdata.org/wp-content/cps/data/cepr_org_1980.zip"
[36] "http://ceprdata.org/wp-content/cps/data/cepr_org_1979.zip"
&gt;
</pre>

<p>
Wow, that that was a lot easier. Why didn't we do that in the first place?!? Well, if we had done it the easy way I wouldn't have had an excuse to teach you about regular expressions!
</p>
</div>
</div>

<div id="outline-container-orgheadline8" class="outline-3">
<h3 id="orgheadline8">Getting the list of data links the easy way</h3>
<div class="outline-text-3" id="text-orgheadline8">
<p>
If you look at the result from 
</p>
</div>
</div>

<div id="outline-container-orgheadline9" class="outline-3">
<h3 id="orgheadline9">Vector types</h3>
<div class="outline-text-3" id="text-orgheadline9">
<p>
Vectors are the building blocks of data objects in R. There are a few basic types, including <code>logical</code>, <code>integer</code> , <code>double</code>, <code>complex</code>, and <code>character</code>. Values can be combined into vectors using the <code>c()</code> function.
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock1">num.var <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span>1, 2, 3, 4<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">numeric vector</span>
char.var <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"1"</span>, <span style="color: #2d9574;">"2"</span>, <span style="color: #2d9574;">"3"</span>, <span style="color: #2d9574;">"4"</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">character vector</span>
log.var <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span><span style="color: #38a882; font-weight: bold;">TRUE</span>, <span style="color: #38a882; font-weight: bold;">TRUE</span>, <span style="color: #38a882; font-weight: bold;">FALSE</span>, <span style="color: #38a882; font-weight: bold;">TRUE</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">logical vector</span>
char.var2 <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span>num.var, char.var<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">numbers coverted to character</span>
</pre>
</div>

<pre class="example">
&gt; num.var &lt;- c(1, 2, 3, 4) # numeric vector
&gt; char.var &lt;- c("1", "2", "3", "4") # character vector
&gt; log.var &lt;- c(TRUE, TRUE, FALSE, TRUE) # logical vector
&gt; char.var2 &lt;- c(num.var, char.var) # numbers coverted to character
&gt;
</pre>

<p>
Vectors can be converted from one class to another using one of the many functions beginning with <code>as.</code>, e.g., <code>as.numeric</code> and <code>as.character</code>.
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock2">class<span style="color: #2f96dc;">(</span>char.var2<span style="color: #2f96dc;">)</span>
num.var2 <span style="color: #a45bad;">&lt;-</span> as.numeric<span style="color: #2f96dc;">(</span>char.var2<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">convert to numeric</span>
class<span style="color: #2f96dc;">(</span>num.var2<span style="color: #2f96dc;">)</span>
mean<span style="color: #2f96dc;">(</span>as.numeric<span style="color: #bc6ec5;">(</span>char.var2<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">now we can calculate the mean</span>
as.numeric<span style="color: #2f96dc;">(</span>c<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"a"</span>, <span style="color: #2d9574;">"b"</span>, <span style="color: #2d9574;">"c"</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">cannot convert letters to numeric</span>
</pre>
</div>

<pre class="example">
&gt; class(char.var2)
[1] "character"
&gt; num.var2 &lt;- as.numeric(char.var2) # convert to numeric
&gt; class(num.var2)
[1] "numeric"
&gt; mean(as.numeric(char.var2)) # now we can calculate the mean
[1] 2.5
&gt; as.numeric(c("a", "b", "c")) # cannot convert letters to numeric
[1] NA NA NA
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline10" class="outline-3">
<h3 id="orgheadline10">Vector attributes</h3>
<div class="outline-text-3" id="text-orgheadline10">
<p>
Vectors (and other R objects for that matter) will always have <code>mode</code> and <code>length</code> attributes. They may optionally have other attributes such as names or comments. 
</p>
<div class="org-src-container">

<pre class="src src-R">ls<span style="color: #2f96dc;">()</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">list objects in our workspace</span>
length<span style="color: #2f96dc;">(</span>char.var<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">how many elements in char.var?</span>
str<span style="color: #2f96dc;">(</span>num.var2<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">what is the structure of num.var2?</span>
names<span style="color: #2f96dc;">(</span>num.var2<span style="color: #2f96dc;">)</span> <span style="color: #a45bad;">&lt;-</span> paste<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"element"</span>, seq_along<span style="color: #bc6ec5;">(</span>num.var2<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
str<span style="color: #2f96dc;">(</span>num.var2<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; ls() # list objects in our workspace
[1] "char.var"   "char.var2"  "isPositive" "log.var"    "num.var"   
[6] "num.var2"   "petal"      "petals"     "updateIR"  
&gt; length(char.var) # how many elements in char.var?
[1] 4
&gt; str(num.var2) # what is the structure of num.var2?
 num [1:8] 1 2 3 4 1 2 3 4
&gt; names(num.var2) &lt;- paste("element", seq_along(num.var2))
&gt; str(num.var2)
 Named num [1:8] 1 2 3 4 1 2 3 4
 - attr(*, "names")= chr [1:8] "element 1" "element 2" "element 3" "element 4" ...
&gt;
</pre>

<pre class="example">
&gt; ls() # list objects in our workspace
[1] "char.var"  "char.var2" "log.var"   "num.var"   "num.var2" 
[6] "tmp"      
&gt; length(char.var) # how many elements in char.var?
[1] 4
&gt; str(num.var2) # what is the structure of num.var2?
 num [1:8] 1 2 3 4 1 2 3 4
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline11" class="outline-3">
<h3 id="orgheadline11">Factor vectors</h3>
<div class="outline-text-3" id="text-orgheadline11">
<p>
Factors are stored as numbers, but have character labels. Factors are useful for
</p>
<ul class="org-ul">
<li>Modeling (automatically contrast coded)</li>
<li>Sorting/presenting values in arbitrary order</li>
</ul>

<p>
Most of the time we can treat factors as though they were character vectors
</p>
</div>
</div>

<div id="outline-container-orgheadline12" class="outline-3">
<h3 id="orgheadline12">Lists and data.frames</h3>
<div class="outline-text-3" id="text-orgheadline12">
<ul class="org-ul">
<li>A <i>data.frame</i> is a list of vectors, each of the same length</li>
<li>A <i>list</i> is a collection of objects each of which can be almost anything</li>
</ul>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock3">DF <span style="color: #a45bad;">&lt;-</span> data.frame<span style="color: #2f96dc;">(</span>x=1:5, y=letters<span style="color: #bc6ec5;">[</span>1:5<span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span>
DF <span style="color: #2aa198;"># </span><span style="color: #2aa198;">data.frame with two columns and 5 rows</span>
DF$x <span style="color: #2aa198;"># </span><span style="color: #2aa198;">select just the x column.</span>

<span style="color: #2aa198;"># </span><span style="color: #2aa198;">DF &lt;- data.frame(x=1:10, y=1:7) # illegal becase lengths differ</span>
L <span style="color: #a45bad;">&lt;-</span> list<span style="color: #2f96dc;">(</span>x=1:5, y=1:3, z = DF<span style="color: #2f96dc;">)</span>
L <span style="color: #2aa198;"># </span><span style="color: #2aa198;">lists are much more flexible!</span>
</pre>
</div>

<pre class="example">
&gt; DF &lt;- data.frame(x=1:5, y=letters[1:5])
&gt; DF # data.frame with two columns and 5 rows
  x y
1 1 a
2 2 b
3 3 c
4 4 d
5 5 e
&gt; 
&gt; # DF &lt;- data.frame(x=1:10, y=1:7) # illegal becase lengths differ
&gt; L &lt;- list(x=1:5, y=1:3, z = DF)
&gt; L # lists are much more flexible!
$x
[1] 1 2 3 4 5

$y
[1] 1 2 3

$z
  x y
1 1 a
2 2 b
3 3 c
4 4 d
5 5 e

&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13">Data types summary</h3>
<div class="outline-text-3" id="text-orgheadline13">
<p>
Key points:
</p>
<ul class="org-ul">
<li>vector classes include numeric, logical, character, and factors</li>
<li>vectors can be combined into lists or  data.frames</li>
<li>a data.frame can almost always be thought of as a list of vectors of equal length</li>
<li>a list is a collection of objects, each of which can by of almost any type</li>
</ul>
<p>
Functions introduced in this section: 
</p>
<dl class="org-dl">
<dt>c</dt><dd>combine elements</dd>
<dt>as.numeric</dt><dd>convert an object (e.g., a character verctor) to numeric</dd>
<dt>data.frame</dt><dd>combine oject into a data.frame</dd>
<dt>ls</dt><dd>list the objects in the workspace</dd>
<dt>class</dt><dd>get the class of an object</dd>
<dt>str</dt><dd>get the structure of an object</dd>
<dt>length</dt><dd>get the number of elements in an object</dd>
<dt>mean</dt><dd>calculate the mean of a vector</dd>
<dt>$</dt><dd>extraction operator, selects a single element from a list or data.frame</dd>
</dl>
</div>
</div>

<div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14">Exercise 0</h3>
<div class="outline-text-3" id="text-orgheadline14">
<p>
Use the built-in <i>iris</i> data set (comes with R, will be available in your workspace automatically).
</p>
<ol class="org-ol">
<li>Determine the <code>class</code> and <code>str</code> ucture of the <i>iris</i> data set.</li>
<li>Determine the class of each column in the iris data set</li>
<li>BONUS (OPTIONAL): Create a new variable by <code>c</code> ombining the Petal.Length and Petal.Width columns</li>
<li>BONUS (OPTIONAL): Create a new data.frame with two columns; the first should be named <i>value</i>, and should be equal to the variable you created in step 3. The second should be named <i>variable</i> and should be either <i>Petal.Length</i> or <i>Petal.Width</i> as appropriate.</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgheadline22" class="outline-2">
<h2 id="orgheadline22">Extracting and replacing object elements</h2>
<div class="outline-text-2" id="text-orgheadline22">
</div><div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15">Indexing by position or name</h3>
<div class="outline-text-3" id="text-orgheadline15">
<p>
Parts of vectors, matricies, data.frames, and lists can be extracted or replaced based on position or name
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock4"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">indexing vectors by position</span>
x <span style="color: #a45bad;">&lt;-</span> 101:110 <span style="color: #2aa198;"># </span><span style="color: #2aa198;">Creat a vector of integers from 101 to 110</span>
x<span style="color: #2f96dc;">[</span>c<span style="color: #bc6ec5;">(</span>4, 5<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">extract the fourth and fifth values of x</span>
x<span style="color: #2f96dc;">[</span>4<span style="color: #2f96dc;">]</span> <span style="color: #a45bad;">&lt;-</span> 1 <span style="color: #2aa198;"># </span><span style="color: #2aa198;">change the 4th value to 1</span>
x <span style="color: #2aa198;"># </span><span style="color: #2aa198;">print x</span>

<span style="color: #2aa198;">## </span><span style="color: #2aa198;">indexing vectors by name</span>
names<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #a45bad;">&lt;-</span> letters<span style="color: #2f96dc;">[</span>1:10<span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">give x names</span>
print<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;">#</span><span style="color: #2aa198;">print x</span>
x<span style="color: #2f96dc;">[</span>c<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"a"</span>, <span style="color: #2d9574;">"f"</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">extract the values of a  and f from x</span>
</pre>
</div>

<pre class="example">
&gt; ## indexing vectors by position
&gt; x &lt;- 101:110 # Creat a vector of integers from 101 to 110
&gt; x[c(4, 5)] # extract the fourth and fifth values of x
[1] 104 105
&gt; x[4] &lt;- 1 # change the 4th value to 1
&gt; x # print x
 [1] 101 102 103   1 105 106 107 108 109 110
&gt; 
&gt; ## indexing vectors by name
&gt; names(x) &lt;- letters[1:10] # give x names
&gt; print(x) #print x
  a   b   c   d   e   f   g   h   i   j 
101 102 103   1 105 106 107 108 109 110 
&gt; x[c("a", "f")] # extract the values of a  and f from x
  a   f 
101 106 
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16">Logical indexing</h3>
<div class="outline-text-3" id="text-orgheadline16">
<p>
Elements can also be selected or replaced based on logical (TRUE/FALSE) vectors.
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock5">x &gt; 106 <span style="color: #2aa198;"># </span><span style="color: #2aa198;">shows which elements of x are &gt; 106</span>
x<span style="color: #2f96dc;">[</span>x &gt; 106<span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">selects elements of x where x &gt; 106</span>
</pre>
</div>

<pre class="example">
&gt; x &gt; 106 # shows which elements of x are &gt; 106
    a     b     c     d     e     f     g     h     i     j 
FALSE FALSE FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE 
&gt; x[x &gt; 106] # selects elements of x where x &gt; 106 
  g   h   i   j 
107 108 109 110 
&gt;
</pre>

<p>
Additional operators useful for logical indexing:
</p>
<dl class="org-dl">
<dt>==</dt><dd>equal to</dd>
<dt>!=</dt><dd>not equal to</dd>
<dt>&gt;</dt><dd>greater than</dd>
<dt>&lt;</dt><dd>less than</dd>
<dt>&gt;=</dt><dd>greater than or equal to</dd>
<dt>&lt;=</dt><dd>less than or equal to</dd>
<dt>%in%</dt><dd>is included in</dd>
<dt>&amp;</dt><dd>and</dd>
<dt>|</dt><dd>or</dd>
</dl>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock6">x<span style="color: #2f96dc;">[</span>x &gt; 106 &amp; x &lt;= 108<span style="color: #2f96dc;">]</span>
x<span style="color: #2f96dc;">[</span>x &gt; 106 | names<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span> %<span style="color: #237fbf; font-weight: bold;">in</span>% c<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"a"</span>, <span style="color: #2d9574;">"b"</span>, <span style="color: #2d9574;">"c"</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span>
</pre>
</div>

<pre class="example">
&gt; x[x &gt; 106 &amp; x &lt;= 108]
  g   h 
107 108 
&gt; x[x &gt; 106 | names(x) %in% c("a", "b", "c")]
  a   b   c   g   h   i   j 
101 102 103 107 108 109 110 
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17">Indexing matrices</h3>
<div class="outline-text-3" id="text-orgheadline17">
<p>
Extraction on matrices operate in two dimensions: first dimension refers to rows, second dimension refers to columns
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock7"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">indexing matricies</span>
 <span style="color: #2aa198;"># </span><span style="color: #2aa198;">create a matrix</span>
<span style="color: #2f96dc;">(</span>M <span style="color: #a45bad;">&lt;-</span> cbind<span style="color: #bc6ec5;">(</span>x = 1:5, y = -1:-5, z = c<span style="color: #2d9574;">(</span>6, 3, 4, 2, 8<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
M<span style="color: #2f96dc;">[</span>1:3, <span style="color: #2f96dc;">]</span> <span style="color: #2aa198;">#</span><span style="color: #2aa198;">extract rows 1 through 3, all columns</span>
M<span style="color: #2f96dc;">[</span>c<span style="color: #bc6ec5;">(</span>5, 3, 1<span style="color: #bc6ec5;">)</span>, 2:3<span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">rows 5, 3 and 1, columns 2 and 3</span>
M<span style="color: #2f96dc;">[</span>M<span style="color: #bc6ec5;">[</span>, 1<span style="color: #bc6ec5;">]</span> %<span style="color: #237fbf; font-weight: bold;">in</span>% 4:2, 2<span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">second column where first column &lt;=4 &amp; &gt;= 2</span>
</pre>
</div>

<pre class="example">
&gt; ## indexing matricies
&gt;  # create a matrix
&gt; (M &lt;- cbind(x = 1:5, y = -1:-5, z = c(6, 3, 4, 2, 8)))
     x  y z
[1,] 1 -1 6
[2,] 2 -2 3
[3,] 3 -3 4
[4,] 4 -4 2
[5,] 5 -5 8
&gt; M[1:3, ] #extract rows 1 through 3, all columns
     x  y z
[1,] 1 -1 6
[2,] 2 -2 3
[3,] 3 -3 4
&gt; M[c(5, 3, 1), 2:3] # rows 5, 3 and 1, columns 2 and 3
      y z
[1,] -5 8
[2,] -3 4
[3,] -1 6
&gt; M[M[, 1] %in% 4:2, 2] # second column where first column &lt;=4 &amp; &gt;= 2
[1] -2 -3 -4
&gt;
</pre>

<p>
Note that unspecified index's (as in the column index in the example above ) return all values.
</p>
</div>
</div>


<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18">Indexing lists</h3>
<div class="outline-text-3" id="text-orgheadline18">
<p>
Lists can be indexed in the same way as vectors, with the following extension:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock8"><span style="color: #2aa198;"># </span><span style="color: #2aa198;">Lists can be indexed with single brackets, similar to vector indexing</span>
L<span style="color: #2f96dc;">[</span>c<span style="color: #bc6ec5;">(</span>1, 2<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">the first two elements of L</span>
L<span style="color: #2f96dc;">[</span>1<span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">a list with one element</span>
<span style="color: #2aa198;">## </span><span style="color: #2aa198;">double brackets select the content of a single selected element</span>
<span style="color: #2aa198;">## </span><span style="color: #2aa198;">effectively taking it out of the list.</span>
L<span style="color: #2f96dc;">[</span><span style="color: #bc6ec5;">[</span>1<span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">a vector</span>
</pre>
</div>

<pre class="example">
&gt; # Lists can be indexed with single brackets, similar to vector indexing
&gt; L[c(1, 2)] # the first two elements of L
$x
[1] 1 2 3 4 5

$y
[1] 1 2 3

&gt; L[1] # a list with one element
$x
[1] 1 2 3 4 5

&gt; ## double brackets select the content of a single selected element
&gt; ## effectively taking it out of the list.
&gt; L[[1]] # a vector
[1] 1 2 3 4 5
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline19" class="outline-3">
<h3 id="orgheadline19">Indexing data.frames</h3>
<div class="outline-text-3" id="text-orgheadline19">
<p>
A data.frame can be indexed in the same ways as a matrix, and also the same ways as a list:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock9">DF<span style="color: #2f96dc;">[</span>c<span style="color: #bc6ec5;">(</span>3, 1, 2<span style="color: #bc6ec5;">)</span>, c<span style="color: #bc6ec5;">(</span>1, 2<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">rows 3, 1, and 2, columns 1 and 2</span>
DF<span style="color: #2f96dc;">[</span><span style="color: #bc6ec5;">[</span>1<span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">column 1 as a vector</span>
</pre>
</div>

<pre class="example">
&gt; DF[c(3, 1, 2), c(1, 2)] # rows 3, 1, and 2, columns 1 and 2
  x y
3 3 c
1 1 a
2 2 b
&gt; DF[[1]] # column 1 as a vector
[1] 1 2 3 4 5
&gt;
</pre>

<p>
There is a subtle but important difference between <code>[ , n]</code> and <code>[n]</code> when indexing data.frames: the first form returns a vector, the second returns a data.frame with one column.
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock10">str<span style="color: #2f96dc;">(</span>DF<span style="color: #bc6ec5;">[</span>1<span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span><span style="color: #2aa198;"># </span><span style="color: #2aa198;">a data.frame with one column</span>
str<span style="color: #2f96dc;">(</span>DF<span style="color: #bc6ec5;">[</span> ,1<span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span><span style="color: #2aa198;"># </span><span style="color: #2aa198;">a vector</span>
</pre>
</div>

<pre class="example">
&gt; str(DF[1])# a data.frame with one column
'data.frame':	5 obs. of  1 variable:
 $ x: int  1 2 3 4 5
&gt; str(DF[ ,1])# a vector
 int [1:5] 1 2 3 4 5
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20">Extraction/replacement summary</h3>
<div class="outline-text-3" id="text-orgheadline20">
<p>
Key points:
</p>

<ul class="org-ul">
<li>elements of objects can be extracted or replaced using the <code>[</code> operator</li>
<li>objects can be indexed by position, name, or logical (TRUE/FALSE) vectors</li>
<li>vectors and lists have only one dimension, and hence only one index is used</li>
<li>matricies and data.frames have two dimensions, and extraction methods for these objects use two indices</li>
</ul>
<p>
Functions introduced in this section: 
</p>
<dl class="org-dl">
<dt>[</dt><dd>extraction operator, used to extract/replace object elements</dd>
<dt>names</dt><dd>get the names of an object, usually a vector, list, or data.frame</dd>
<dt>print</dt><dd>print an object</dd>
</dl>
</div>
</div>


<div id="outline-container-orgheadline21" class="outline-3">
<h3 id="orgheadline21">Exercise 1</h3>
<div class="outline-text-3" id="text-orgheadline21">
<ol class="org-ol">
<li>Select just the Sepal.Length and Species columns from the <i>iris</i> data set (built-in, will be available in your workspace automatically) and save the result to a new data.frame named <i>iris.2</i></li>
<li>Calculate the mean of the Sepal.Length column in <i>iris.2</i></li>
<li>BONUS (optional): Calculate the mean of Sepal.Length, but only for the setosa species</li>
<li>BONUS (optional): Calculate the number of sepal lengths that are more than one standard deviation below the average sepal length</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgheadline23" class="outline-2">
<h2 id="orgheadline23">Looping and applying</h2>
<div class="outline-text-2" id="text-orgheadline23">
<p>
<code>for</code> and <code>while</code> loops in R work much the same as they do in other programming languages. R also has an <code>apply</code> family of functions that are sometimes more convenient.
</p>
</div>
<div id="outline-container-orgheadline24" class="outline-3">
<h3 id="orgheadline24">The apply function</h3>
<div class="outline-text-3" id="text-orgheadline24">
<p>
The apply function is used to apply a function to the rows or columns of a matrix
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock11">M <span style="color: #a45bad;">&lt;-</span> matrix<span style="color: #2f96dc;">(</span>1:20,
            ncol=4,
            dimnames = list<span style="color: #bc6ec5;">(</span>paste<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"row"</span>, 1:5<span style="color: #2d9574;">)</span>,
                            paste<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"col"</span>, 1:4<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
apply<span style="color: #2f96dc;">(</span>M, 1, mean<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;">## </span><span style="color: #2aa198;">average across the rows</span>
apply<span style="color: #2f96dc;">(</span>M, 2, sum<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;">## </span><span style="color: #2aa198;">sum down the columns</span>
</pre>
</div>

<pre class="example">
&gt; M &lt;- matrix(1:20, ncol=4)
&gt; apply(M, 2, mean) ## average across the rows
[1]  3  8 13 18
&gt; apply(M, 2, sum) ## sum the columns
[1] 15 40 65 90
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline25" class="outline-3">
<h3 id="orgheadline25">for loops</h3>
<div class="outline-text-3" id="text-orgheadline25">
<p>
We can alternatively calculate row and column means, but in this case <code>apply</code> is easier.
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock12">M.means <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">()</span> <span style="color: #2aa198;">## </span><span style="color: #2aa198;">empty vector to hold the result</span>
<span style="color: #237fbf; font-weight: bold;">for</span> <span style="color: #2f96dc;">(</span>row <span style="color: #237fbf; font-weight: bold;">in</span> rownames<span style="color: #bc6ec5;">(</span>M<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    M.means<span style="color: #bc6ec5;">[</span>row<span style="color: #bc6ec5;">]</span> <span style="color: #a45bad;">&lt;-</span> mean<span style="color: #bc6ec5;">(</span>M<span style="color: #2d9574;">[</span>row, <span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span>
<span style="color: #2f96dc;">}</span>

M.sums <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">()</span> <span style="color: #2aa198;">## </span><span style="color: #2aa198;">empty vector to hold the result</span>
<span style="color: #237fbf; font-weight: bold;">for</span> <span style="color: #2f96dc;">(</span>col <span style="color: #237fbf; font-weight: bold;">in</span> colnames<span style="color: #bc6ec5;">(</span>M<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    M.sums<span style="color: #bc6ec5;">[</span>col<span style="color: #bc6ec5;">]</span> <span style="color: #a45bad;">&lt;-</span> mean<span style="color: #bc6ec5;">(</span>M<span style="color: #2d9574;">[</span>, col<span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span>
<span style="color: #2f96dc;">}</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline26" class="outline-3">
<h3 id="orgheadline26">The sapply function</h3>
<div class="outline-text-3" id="text-orgheadline26">
<p>
It is often useful to apply a function to each element of a vector, list, or data.frame; you can use the <code>sapply</code> function for this
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock13">sapply<span style="color: #2f96dc;">(</span>DF, class<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">get the class of each column in the DF data.frame</span>
sapply<span style="color: #2f96dc;">(</span>L, length<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">get the length of each element in the L list</span>
sapply<span style="color: #2f96dc;">(</span>DF, is.numeric<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">check each column of DF to see if it is numeric</span>
</pre>
</div>

<pre class="example">
&gt; sapply(DF, class) # get the class of each column in the DF data.frame
        x         y 
"integer"  "factor" 
&gt; sapply(L, length) # get the length of each element in the L list
x y z 
5 3 2 
&gt; sapply(DF, is.numeric) # check each column of DF to see if it is numeric
    x     y 
 TRUE FALSE 
&gt;
</pre>

<p>
See also: <code>lapply</code>, <code>vapply</code>, and <code>mapply</code>.
</p>
</div>
</div>
<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27">Combining sapply and indexing</h3>
<div class="outline-text-3" id="text-orgheadline27">
<p>
The <code>sapply</code> function can be used in combination with indexing to extract elements that meet certain criteria
</p>
<ul class="org-ul">
<li>Recall that we can index using logical vectors:</li>
</ul>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock14">DF<span style="color: #2f96dc;">[</span>, c<span style="color: #bc6ec5;">(</span><span style="color: #38a882; font-weight: bold;">TRUE</span>, <span style="color: #38a882; font-weight: bold;">FALSE</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">select the first column of DF, but not the second</span>
</pre>
</div>

<pre class="example">
&gt; DF[, c(TRUE, FALSE)] # select the first column of DF, but not the second
[1] 1 2 3 4 5
&gt;
</pre>

<pre class="example">
&gt; ## recall that we can index using logical vectors:
&gt; DF[, c(TRUE, FALSE)] # select the first column of DF, but not the second
[1] 1 2 3 4 5
&gt;
</pre>

<ul class="org-ul">
<li><code>sapply()</code> can be used to generate the logical vector</li>
</ul>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock15"><span style="color: #2f96dc;">(</span>DF.which.num <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>DF, is.numeric<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span><span style="color: #2aa198;"># </span><span style="color: #2aa198;">check which columns of DF are numeric</span>
DF<span style="color: #2f96dc;">[</span>DF.which.num<span style="color: #2f96dc;">]</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">select the numeric columns</span>
</pre>
</div>

<pre class="example">
&gt; (DF.which.num &lt;- sapply(DF, is.numeric))# check which columns of DF are numeric
    x     y 
 TRUE FALSE 
&gt; DF[DF.which.num] # select the numeric columns
  x
1 1
2 2
3 3
4 4
5 5
&gt;
</pre>

<p>
Note the difference between <code>DF[, 1]</code> and <code>DF[1]</code>! The first form returns a vector, the second a data.frame with one column. 
</p>
</div>
</div>

<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28">Applying functions summary</h3>
<div class="outline-text-3" id="text-orgheadline28">
<p>
Key points:
</p>
<ul class="org-ul">
<li>R has convenient methods for applying functions to matricies, lists, and data.frames</li>
<li>other apply-style functions exist, e.g., lapply, tapply, and mapply (see documentation of these functions for details</li>
</ul>
<p>
Functions introduced in this section: 
</p>
<dl class="org-dl">
<dt>matrix</dt><dd>create a matrix (vector with two dimensions)</dd>
<dt>apply</dt><dd>apply a function to the rows or columns of a matrix</dd>
<dt>sapply</dt><dd>apply a function to the elements of a list</dd>
<dt>is.numeric</dt><dd>returns TRUE or FALSE, depending on the type of object</dd>
</dl>
</div>
</div>
</div>

<div id="outline-container-orgheadline35" class="outline-2">
<h2 id="orgheadline35">Writing functions</h2>
<div class="outline-text-2" id="text-orgheadline35">
</div><div id="outline-container-orgheadline29" class="outline-3">
<h3 id="orgheadline29">Functions</h3>
<div class="outline-text-3" id="text-orgheadline29">
<ul class="org-ul">
<li>A function is a collection of commands that takes input(s) and returns output.</li>
<li>If you have a specific analysis or transformation you want to do on different data, use a function</li>
<li>Functions are defined using the <code>function()</code> function</li>
<li>Functions can be defined with any number of named arguments</li>
<li>Arguments can be of any type (e.g., vectors, data.frames, lists &#x2026;)</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30">Function return value</h3>
<div class="outline-text-3" id="text-orgheadline30">
<ul class="org-ul">
<li>The return value of a function can be:
<ul class="org-ul">
<li>The last object stored in the body of the function</li>
<li>Objects explicitly returned with the <code>return()</code> function</li>
</ul></li>
<li>Other function output can come from:
<ul class="org-ul">
<li>Calls to <code>print()</code>, <code>message()</code> or <code>cat()</code> in function body</li>
<li>Error messages</li>
</ul></li>
<li>Assignment inside the body of a function takes place in a local environment</li>
<li>Example:</li>
</ul>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock16"><span style="color: #bc6ec5; font-weight: bold;">f</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">()</span> <span style="color: #2f96dc;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">define function f</span>
print<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"setting x to 1"</span><span style="color: #bc6ec5;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">print a text string</span>
x <span style="color: #a45bad;">&lt;-</span> 1<span style="color: #2f96dc;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">set x to 1</span>

y <span style="color: #a45bad;">&lt;-</span> f<span style="color: #2f96dc;">()</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">assign y the value returned by f</span>

y <span style="color: #2aa198;"># </span><span style="color: #2aa198;">print y</span>
x <span style="color: #2aa198;"># </span><span style="color: #2aa198;">x in the global is not 1!</span>
</pre>
</div>

<pre class="example">
&gt; f &lt;- function() { # define function f
+ print("setting x to 1") # print a text string
+ x &lt;- 1} # set x to 1
&gt; 
&gt; y &lt;- f() # assign y the value returned by f
[1] "setting x to 1"
&gt; 
&gt; y # print y
[1] 1
&gt; x # x in the global is not 1!
  a   b   c   d   e   f   g   h   i   j 
101 102 103   1 105 106 107 108 109 110 
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline31" class="outline-3">
<h3 id="orgheadline31">Writing functions example</h3>
<div class="outline-text-3" id="text-orgheadline31">
<p>
Goal: write a function that returns the square of it's argument
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock17"><span style="color: #bc6ec5; font-weight: bold;">square</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span> <span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">define function named "square" with argument x</span>
  <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>x*x<span style="color: #bc6ec5;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">multiple the x argument by itself</span>
<span style="color: #2f96dc;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">end the function definition</span>

<span style="color: #2aa198;"># </span><span style="color: #2aa198;">check to see that the function works</span>
square<span style="color: #2f96dc;">(</span>x = 2<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">square the value 2</span>
square<span style="color: #2f96dc;">(</span>10<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">square the value 10</span>
square<span style="color: #2f96dc;">(</span>1:5<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">square integers 1 through 5</span>
</pre>
</div>

<pre class="example">
&gt; square &lt;- function (x) { # define function named "square" with argument x
+   return(x*x) # multiple the x argument by itself
+ } # end the function definition
&gt; 
&gt; # check to see that the function works
&gt; square(x = 2) # square the value 2
[1] 4
&gt; square(10) # square the value 10
[1] 100
&gt; square(1:5) # square integers 1 through 5
[1]  1  4  9 16 25
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline32" class="outline-3">
<h3 id="orgheadline32">Debugging basics</h3>
<div class="outline-text-3" id="text-orgheadline32">
<p>
Stepping througth functions and setting breakpoints
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock18"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">Debugging</span>
<span style="color: #2aa198;"># </span><span style="color: #2aa198;">write my.mean function</span>
<span style="color: #bc6ec5; font-weight: bold;">my.mean</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span> <span style="color: #2f96dc;">(</span>x, ...<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
  S <span style="color: #a45bad;">&lt;-</span> sum<span style="color: #bc6ec5;">(</span>x, ...<span style="color: #bc6ec5;">)</span>
  L <span style="color: #a45bad;">&lt;-</span> length<span style="color: #bc6ec5;">(</span>na.omit<span style="color: #2d9574;">(</span>x<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>S / L<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>
debug<span style="color: #2f96dc;">(</span>my.mean<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">turn debugger on for my.mean function</span>
<span style="color: #2aa198;"># </span><span style="color: #2aa198;">mymean() # step through the function</span>
undebug<span style="color: #2f96dc;">(</span>my.mean<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">to turn the debugger off</span>
<span style="color: #2aa198;"># </span><span style="color: #2aa198;">insert breakpoints</span>
<span style="color: #bc6ec5; font-weight: bold;">my.mean</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span> <span style="color: #2f96dc;">(</span>x, ...<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
  S <span style="color: #a45bad;">&lt;-</span> sum<span style="color: #bc6ec5;">(</span>x, ...<span style="color: #bc6ec5;">)</span>
  L <span style="color: #a45bad;">&lt;-</span> length<span style="color: #bc6ec5;">(</span>na.omit<span style="color: #2d9574;">(</span>x<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
  browser<span style="color: #bc6ec5;">()</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">function will stop here so you can inspect S and L</span>
  <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>S / L<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>
</pre>
</div>

<pre class="example">
&gt; ## Debugging
&gt; # write my.mean function
&gt; my.mean &lt;- function (x, ...) {
+   S &lt;- sum(x, ...)
+   L &lt;- length(na.omit(x))
+   return(S / L)}
&gt; debug(my.mean) # turn debugger on for my.mean function
&gt; # mymean() # step through the function
&gt; undebug(my.mean) # to turn the debugger off
&gt; # insert breakpoints
&gt; my.mean &lt;- function (x, ...) {
+   S &lt;- sum(x, ...)
+   L &lt;- length(na.omit(x))
+   browser() # function will stop here so you can inspect S and L
+   return(S / L)}
&gt;
</pre>

<p>
Use <code>traceback()</code> to see what went wrong after the fact
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock19">myModel <span style="color: #a45bad;">&lt;-</span> lm<span style="color: #2f96dc;">(</span><span style="color: #38a882; font-weight: bold;">NA</span>~<span style="color: #38a882; font-weight: bold;">NA</span><span style="color: #2f96dc;">)</span>
traceback<span style="color: #2f96dc;">()</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline33" class="outline-3">
<h3 id="orgheadline33">Writing functions summary</h3>
<div class="outline-text-3" id="text-orgheadline33">
<p>
Key points:
</p>
<ul class="org-ul">
<li>writing new functions is easy!</li>
<li>most functions will have a return value, but functions can also print things, write things to file etc.</li>
<li>functions can be stepped through to facilitate debugging</li>
</ul>
<p>
Functions introduced in this section  
</p>
<dl class="org-dl">
<dt>function</dt><dd>defines a new function</dd>
<dt>return</dt><dd>used inside a function definition to set the return value</dd>
<dt>browser</dt><dd>sets a break point</dd>
<dt>debug</dt><dd>turns on the debugging flag of a function so you can step through it</dd>
<dt>undebug</dt><dd>turns off the debugging flag</dd>
<dt>traceback</dt><dd>shows the error stack (call after an error to see what went wrong)</dd>
</dl>
</div>
</div>



<div id="outline-container-orgheadline34" class="outline-3">
<h3 id="orgheadline34">Exercise 2</h3>
<div class="outline-text-3" id="text-orgheadline34">
<ol class="org-ol">
<li>Write a function that takes a data.frame as an argument and returns the mean of each numeric column in the data frame. Test your function using the iris data.</li>

<li>Modify your function so that it returns a list, the first element if which is the means of the numeric variables, the second of which is the counts of the levels of each categorical variable.</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgheadline42" class="outline-2">
<h2 id="orgheadline42">Control flow</h2>
<div class="outline-text-2" id="text-orgheadline42">
</div><div id="outline-container-orgheadline36" class="outline-3">
<h3 id="orgheadline36">Control flow</h3>
<div class="outline-text-3" id="text-orgheadline36">
<ul class="org-ul">
<li>Basic idea: if some condition is true, do one thing. If false, do something else</li>
<li>Carried out in R using <code>if()</code> and <code>else()</code> statements, which can be nested if necessary</li>
<li>Especially useful for checking function arguments and performing different operations depending on function input</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline37" class="outline-3">
<h3 id="orgheadline37">Control flow examples</h3>
<div class="outline-text-3" id="text-orgheadline37">
<p>
Goal: write a function that tells us if a number is positive or negative
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock20"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">use branching to return different result depending on the sign of the input</span>
<span style="color: #bc6ec5; font-weight: bold;">isPositive</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">define function "isPositive"</span>
  <span style="color: #237fbf; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>x &gt; 0<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">if x is greater than zero, then</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x, <span style="color: #2d9574;">"is positive \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say so! </span>
  <span style="color: #237fbf; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">otherwise</span>
      <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x, <span style="color: #2d9574;">"is negative \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say x is negative</span>
<span style="color: #2f96dc;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">end function definition </span>

<span style="color: #2aa198;">## </span><span style="color: #2aa198;">test the isPositive() function</span>
isPositive<span style="color: #2f96dc;">(</span>10<span style="color: #2f96dc;">)</span>
isPositive<span style="color: #2f96dc;">(</span>-1<span style="color: #2f96dc;">)</span>
isPositive<span style="color: #2f96dc;">(</span>0<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; ## use branching to return different result depending on the sign of the input
&gt; isPositive &lt;- function(x) { # define function "isPositive"
+   if (x &gt; 0) { # if x is greater than zero, then
+     return(paste(x, "is positive \n")) } # say so! 
+   else { # otherwise
+       return(paste(x, "is negative \n"))} # say x is negative
+ } # end function definition 
&gt; 
&gt; ## test the isPositive() function
&gt; isPositive(10)
[1] "10 is positive \n"
&gt; isPositive(-1)
[1] "-1 is negative \n"
&gt; isPositive(0)
[1] "0 is negative \n"
&gt;
</pre>

<p>
Need to do something different if x equals zero!
</p>
</div>
</div>

<div id="outline-container-orgheadline38" class="outline-3">
<h3 id="orgheadline38">Control flow examples</h3>
<div class="outline-text-3" id="text-orgheadline38">
<p>
Add a condition to handle <code>x = 0</code>
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock21"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">add condition to handle the case that x is zero</span>
  <span style="color: #bc6ec5; font-weight: bold;">isPositive</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">define function "isPositive"</span>
    <span style="color: #237fbf; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>x &gt; 0<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">if x is greater than zero, then</span>
      <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x, <span style="color: #2d9574;">"is positive \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say so! </span>
    <span style="color: #237fbf; font-weight: bold;">else</span> <span style="color: #237fbf; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>x == 0<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">otherwise if x is zero</span>
      <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x, <span style="color: #2d9574;">"is zero \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say so!</span>
    <span style="color: #237fbf; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;">#</span><span style="color: #2aa198;">otherwise</span>
        <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x, <span style="color: #2d9574;">"is negative \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say x is negative</span>
  <span style="color: #2f96dc;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">end function definition</span>
</pre>
</div>

<pre class="example">
&gt; ## add condition to handle the case that x is zero
&gt;   isPositive &lt;- function(x) { # define function "isPositive"
+     if (x &gt; 0) { # if x is greater than zero, then
+       return(paste(x, "is positive \n")) } # say so! 
+     else if (x == 0) { # otherwise if x is zero
+       return(paste(x, "is zero \n"))} # say so!
+     else { #otherwise
+         return(paste(x, "is negative \n"))} # say x is negative
+   } # end function definition
&gt;
</pre>

<p>
Test the new function
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock22">isPositive<span style="color: #2f96dc;">(</span>0<span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">test the isPositive() function</span>
isPositive<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"a"</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;">#</span><span style="color: #2aa198;">oops, that will not work!</span>
</pre>
</div>

<pre class="example">
&gt; isPositive(0) # test the isPositive() function
[1] "0 is zero \n"
&gt; isPositive("a") #oops, that will not work!
[1] "a is positive \n"
&gt;
</pre>

<p>
We fixed the problem when <code>x = 0</code>, but now we need to make sure x is numeric of length one (unless we agree with R that <code>a</code> is positive!)
</p>
</div>
</div>

<div id="outline-container-orgheadline39" class="outline-3">
<h3 id="orgheadline39">Control flow examples</h3>
<div class="outline-text-3" id="text-orgheadline39">
<p>
Do something reasonable if x is not numeric
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock23"><span style="color: #2aa198;">## </span><span style="color: #2aa198;">add condition to handle the case that x is zero</span>
  <span style="color: #bc6ec5; font-weight: bold;">isPositive</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">define function "isPositive"</span>
    <span style="color: #237fbf; font-weight: bold;">if</span><span style="color: #bc6ec5;">(</span>!is.numeric<span style="color: #2d9574;">(</span>x<span style="color: #2d9574;">)</span> | length<span style="color: #2d9574;">(</span>x<span style="color: #2d9574;">)</span> &gt; 1<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span>
      <span style="color: #237fbf; font-weight: bold;">stop</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">"x must be a numeric vector of length one! \n"</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">}</span>
    <span style="color: #237fbf; font-weight: bold;">else</span> <span style="color: #237fbf; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>x &gt; 0<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">if x is greater than zero, then</span>
      <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x,<span style="color: #2d9574;">" is positive \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say so! </span>
    <span style="color: #237fbf; font-weight: bold;">else</span> <span style="color: #237fbf; font-weight: bold;">if</span> <span style="color: #bc6ec5;">(</span>x == 0<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">otherwise if x is zero</span>
      <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x,<span style="color: #2d9574;">" is zero \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say so!</span>
    <span style="color: #237fbf; font-weight: bold;">else</span> <span style="color: #bc6ec5;">{</span> <span style="color: #2aa198;">#</span><span style="color: #2aa198;">otherwise</span>
      <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>paste<span style="color: #67b11d;">(</span>x,<span style="color: #2d9574;">" is negative \n"</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">say x is negative</span>
  <span style="color: #2f96dc;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">end function definition</span>

isPositive<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"a"</span><span style="color: #2f96dc;">)</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">test the isPositive() function on character</span>
</pre>
</div>

<pre class="example">
&gt; isPositive("a")
Error in isPositive("a") : x must be a numeric vector of length one!
</pre>
</div>
</div>


<div id="outline-container-orgheadline40" class="outline-3">
<h3 id="orgheadline40">Control flow summary</h3>
<div class="outline-text-3" id="text-orgheadline40">
<p>
Key points:
</p>
<ul class="org-ul">
<li>code can be conditionally executed</li>
<li>conditions can be nested</li>
<li>conditional execution is often used for argument checking, among other things</li>
</ul>

<p>
Functions introduced in this section  
</p>
<dl class="org-dl">
<dt>paste</dt><dd>concatenates (character) vectors</dd>
<dt>if</dt><dd>execute code only if condition is met</dd>
<dt>else</dt><dd>used with <b>if</b>; code to execute if condition is not met</dd>
</dl>
</div>
</div>


<div id="outline-container-orgheadline41" class="outline-3">
<h3 id="orgheadline41">Exercise 3</h3>
<div class="outline-text-3" id="text-orgheadline41">
<ol class="org-ol">
<li>Add argument checking code to return an error if the argument to your function is not a data.frame</li>

<li>Insert a break point with <code>browser()</code> and step through your function</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgheadline50" class="outline-2">
<h2 id="orgheadline50">The S3 object class system</h2>
<div class="outline-text-2" id="text-orgheadline50">
</div><div id="outline-container-orgheadline43" class="outline-3">
<h3 id="orgheadline43">The S3 object class system</h3>
<div class="outline-text-3" id="text-orgheadline43">
<p>
R has two major object systems: 
</p>
<ul class="org-ul">
<li>Relatively informal "S3" classes</li>
<li>Stricter, more formal "S4" classes</li>
</ul>
<ul class="org-ul">
<li>We will cover only the S3 system, not the S4 system</li>
<li>Basic idea: functions have different methods for different types of objects</li>
</ul>
</div>
</div>

<div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44">Object class</h3>
<div class="outline-text-3" id="text-orgheadline44">
<p>
The class of an object can be retrieved and modified using the <code>class()</code> function:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock24">x <span style="color: #a45bad;">&lt;-</span> 1:10
class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> 
class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #2d9574;">"foo"</span>
class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; x &lt;- 1:10
&gt; class(x) 
[1] "integer"
&gt; class(x) &lt;- "foo"
&gt; class(x)
[1] "foo"
&gt;
</pre>

<p>
Objects are not limited to a single class, and can have many classes:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock25">class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span><span style="color: #2d9574;">"A"</span>, <span style="color: #2d9574;">"B"</span><span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; class(x) &lt;- c("A", "B")
&gt; class(x) 
[1] "A" "B"
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline45" class="outline-3">
<h3 id="orgheadline45">Function methods</h3>
<div class="outline-text-3" id="text-orgheadline45">
<ul class="org-ul">
<li>Functions can have many methods, allowing us to have (e.g.) one plot() function that does different things depending on what is being plotted()</li>
<li>Methods can only be defined for generic functions: plot, print, summary, mean, and several others are already generic</li>
</ul>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock26"><span style="color: #2aa198;"># </span><span style="color: #2aa198;">see what methods have been defined for the mean function</span>
methods<span style="color: #2f96dc;">(</span>mean<span style="color: #2f96dc;">)</span>
<span style="color: #2aa198;"># </span><span style="color: #2aa198;">which functions have methods for data.frames?</span>
methods<span style="color: #2f96dc;">(</span>class=<span style="color: #2d9574;">"data.frame"</span><span style="color: #2f96dc;">)[</span>1:9<span style="color: #2f96dc;">]</span>
</pre>
</div>

<pre class="example">
&gt; # see what methods have been defined for the mean function
&gt; methods(mean)
[1] mean.Date     mean.default  mean.difftime mean.POSIXct 
[5] mean.POSIXlt 
&gt; # which functions have methods for data.frames?
&gt; methods(class="data.frame")[1:9]
[1] "[.data.frame"             "[[.data.frame"           
[3] "[[&lt;-.data.frame"          "[&lt;-.data.frame"          
[5] "$&lt;-.data.frame"           "aggregate.data.frame"    
[7] "anyDuplicated.data.frame" "as.data.frame.data.frame"
[9] "as.list.data.frame"      
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline46" class="outline-3">
<h3 id="orgheadline46">Creating new function methods</h3>
<div class="outline-text-3" id="text-orgheadline46">
<p>
To create a new method for a function that is already generic all you have to do is name your function <code>function.class</code>
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock27"><span style="color: #2aa198;"># </span><span style="color: #2aa198;">create a mean() method for objects of class "foo":</span>
<span style="color: #bc6ec5; font-weight: bold;">mean.foo</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">mean method for "foo" class</span>
  <span style="color: #237fbf; font-weight: bold;">if</span><span style="color: #bc6ec5;">(</span>is.numeric<span style="color: #2d9574;">(</span>x<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">{</span>
    cat<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"The average is"</span>, mean.default<span style="color: #67b11d;">(</span>x<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #2d9574;">(</span>invisible<span style="color: #67b11d;">(</span>mean.default<span style="color: #b1951d;">(</span>x<span style="color: #b1951d;">)</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span> <span style="color: #2aa198;">#</span><span style="color: #2aa198;">use mean.default for numeric</span>
  <span style="color: #bc6ec5;">}</span> <span style="color: #237fbf; font-weight: bold;">else</span>
    cat<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"x is not numeric \n"</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span> <span style="color: #2aa198;"># </span><span style="color: #2aa198;">otherwise say x not numeric</span>

x <span style="color: #a45bad;">&lt;-</span> 1:10
mean<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #2d9574;">"foo"</span>
mean<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>

x <span style="color: #a45bad;">&lt;-</span> as.character<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #2d9574;">"foo"</span>
mean<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; # create a mean() method for objects of class "foo":
&gt; mean.foo &lt;- function(x) { # mean method for "foo" class
+   if(is.numeric(x)) {
+     cat("The average is", mean.default(x))
+     return(invisible(mean.default(x))) #use mean.default for numeric
+   } else
+     cat("x is not numeric \n")} # otherwise say x not numeric
&gt; 
&gt; x &lt;- 1:10
&gt; mean(x)
[1] 5.5
&gt; class(x) &lt;- "foo"
&gt; mean(x)
The average is 5.5&gt;  
&gt; x &lt;- as.character(x)
&gt; class(x) &lt;- "foo"
&gt; mean(x)
x is not numeric 
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline47" class="outline-3">
<h3 id="orgheadline47">Creating generic functions</h3>
<div class="outline-text-3" id="text-orgheadline47">
<p>
S3 generics are most often used for print, summary, and plot methods, but sometimes you may want to create a new generic function
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock28"><span style="color: #2aa198;"># </span><span style="color: #2aa198;">create a generic disp() function</span>
<span style="color: #bc6ec5; font-weight: bold;">disp</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x, ...<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
  UseMethod<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"disp"</span><span style="color: #bc6ec5;">)</span>
<span style="color: #2f96dc;">}</span>

<span style="color: #2aa198;"># </span><span style="color: #2aa198;">create a disp method for class "matrix"</span>
<span style="color: #bc6ec5; font-weight: bold;">disp.matrix</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
  print<span style="color: #bc6ec5;">(</span>round<span style="color: #2d9574;">(</span>x, digits=2<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
<span style="color: #2f96dc;">}</span>

<span style="color: #2aa198;"># </span><span style="color: #2aa198;">test it out</span>
disp<span style="color: #2f96dc;">(</span>matrix<span style="color: #bc6ec5;">(</span>runif<span style="color: #2d9574;">(</span>10<span style="color: #2d9574;">)</span>, ncol=2<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; # create a generic disp() function
&gt; disp &lt;- function(x, ...) {
+   UseMethod("disp")
+ }
&gt; 
&gt; # create a disp method for class "matrix"
&gt; disp.matrix &lt;- function(x) {
+   print(round(x, digits=2))
+ }
&gt; 
&gt; # test it out
&gt; disp(matrix(runif(10), ncol=2))  
     [,1] [,2]
[1,] 0.45 0.79
[2,] 0.96 0.36
[3,] 0.14 0.06
[4,] 0.78 0.57
[5,] 0.80 0.66
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline48" class="outline-3">
<h3 id="orgheadline48">S3 classes summary</h3>
<div class="outline-text-3" id="text-orgheadline48">
<p>
Key points:
</p>
<ul class="org-ul">
<li>there are several class systems in R, of which S3 is the oldest and simplest</li>
<li>objects have <i>class</i> and functions have corresponding <i>methods</i></li>
<li>the class of an object can be set by simple assignment</li>
<li>S3 generic functions all contain <code>UseMethod("x")</code> in the body, where <code>x</code> is the name of the function</li>
<li>new methods for existing generic functions can be written simply by defining a new function with a special naming scheme: the name of the function followed by dot followed by the name of the class</li>
</ul>

<p>
Functions introduced in this section  
</p>
<dl class="org-dl">
<dt>plot</dt><dd>creates a graphical display, the type of which depends on the class of the object being plotted</dd>
<dt>methods</dt><dd>lists the methods defined for a function or class</dd>
<dt>UseMethod</dt><dd>the body of a generic function</dd>
<dt>invisible</dt><dd>returns an object but does not print it</dd>
</dl>
</div>
</div>



<div id="outline-container-orgheadline49" class="outline-3">
<h3 id="orgheadline49">Exercise 4</h3>
<div class="outline-text-3" id="text-orgheadline49">
<ol class="org-ol">
<li>Modify your function so that it also returns the standard deviations of the numeric variables</li>

<li>Modify your function so that it returns a list of class "statsum"</li>

<li>Write a print method for the statsum class</li>
</ol>
</div>
</div>
</div>



<div id="outline-container-orgheadline57" class="outline-2">
<h2 id="orgheadline57">Things that may surprise you</h2>
<div class="outline-text-2" id="text-orgheadline57">
</div><div id="outline-container-orgheadline51" class="outline-3">
<h3 id="orgheadline51">Gotcha's</h3>
<div class="outline-text-3" id="text-orgheadline51">
<ul class="org-ul">
<li>There are an unfortunately large number of surprises in R programming</li>
<li>Some of these "gotcha's" are common problems in other languages, many are unique to R</li>
<li>We will only cover a few &#x2013; for a more comprehensive discussion please see <a href="http://www.burns-stat.com/pages/Tutor/R_inferno.pdf">http://www.burns-stat.com/pages/Tutor/R_inferno.pdf</a></li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline52" class="outline-3">
<h3 id="orgheadline52">Floating point comparison</h3>
<div class="outline-text-3" id="text-orgheadline52">
<p>
Floating point arithmetic is not exact:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock29">.1 == .3/3
</pre>
</div>

<pre class="example">
&gt; .1 == .3/3
[1] FALSE
&gt;
</pre>

<p>
Solution: <code>use all.equal()</code>:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock30">all.equal<span style="color: #2f96dc;">(</span>.1, .3/3<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; all.equal(.1, .3/3)
[1] TRUE
&gt;
</pre>
</div>
</div>

<div id="outline-container-orgheadline53" class="outline-3">
<h3 id="orgheadline53">Missing values</h3>
<div class="outline-text-3" id="text-orgheadline53">
<p>
R does not exclude missing values by default &#x2013; a single missing value in a vector means that many thing are unknown:
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock31">x <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span>1:10, <span style="color: #38a882; font-weight: bold;">NA</span>, 12:20<span style="color: #2f96dc;">)</span>
c<span style="color: #2f96dc;">(</span>mean<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span>, sd<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span>, median<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span>, min<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span>, sd<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; x &lt;- c(1:10, NA, 12:20)
&gt; c(mean(x), sd(x), median(x), min(x), sd(x))
[1] NA NA NA NA NA
&gt;
</pre>

<p>
NA is not equal to anything, not even NA
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock32"><span style="color: #38a882; font-weight: bold;">NA</span> == <span style="color: #38a882; font-weight: bold;">NA</span>
</pre>
</div>

<pre class="example">
&gt; NA == NA
[1] NA
&gt;
</pre>

<p>
Solutions: use <code>na.rm = TRUE</code> option when calculating, and is.na to test for missing
</p>
</div>
</div>

<div id="outline-container-orgheadline54" class="outline-3">
<h3 id="orgheadline54">Automatic type conversion</h3>
<div class="outline-text-3" id="text-orgheadline54">
<p>
Automatic type conversion happens a lot which is often useful, but makes it easy to miss mistakes
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock33"><span style="color: #2aa198;"># </span><span style="color: #2aa198;">combining values coereces them to the most general type</span>
<span style="color: #2f96dc;">(</span>x <span style="color: #a45bad;">&lt;-</span> c<span style="color: #bc6ec5;">(</span><span style="color: #38a882; font-weight: bold;">TRUE</span>, <span style="color: #38a882; font-weight: bold;">FALSE</span>, 1, 2, <span style="color: #2d9574;">"a"</span>, <span style="color: #2d9574;">"b"</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
str<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>

<span style="color: #2aa198;"># </span><span style="color: #2aa198;">comparisons convert arguments to most general type</span>
1 &gt; <span style="color: #2d9574;">"a"</span>
</pre>
</div>

<pre class="example">
&gt; # combining values coereces them to the most general type
&gt; (x &lt;- c(TRUE, FALSE, 1, 2, "a", "b"))
[1] "TRUE"  "FALSE" "1"     "2"     "a"     "b"    
&gt; str(x)
 chr [1:6] "TRUE" "FALSE" "1" "2" "a" "b"
&gt; 
&gt; # comparisons convert arguments to most general type
&gt; 1 &gt; "a"
[1] FALSE
&gt;
</pre>

<p>
Maybe this is what you expect&#x2026; I would like to at least get a warning!
</p>
</div>
</div>

<div id="outline-container-orgheadline55" class="outline-3">
<h3 id="orgheadline55">Optional argument inconsistencies</h3>
<div class="outline-text-3" id="text-orgheadline55">
<p>
Functions you might expect to work similarly don't always:
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock34">mean<span style="color: #2f96dc;">(</span>1, 2, 3, 4, 5<span style="color: #2f96dc;">)</span>*5
sum<span style="color: #2f96dc;">(</span>1, 2, 3, 4, 5<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; mean(1, 2, 3, 4, 5)*5
[1] 5
&gt; sum(1, 2, 3, 4, 5)
[1] 15
&gt;
</pre>

<p>
Why are these different?!?
</p>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock35">args<span style="color: #2f96dc;">(</span>mean<span style="color: #2f96dc;">)</span>
args<span style="color: #2f96dc;">(</span>sum<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; args(mean)
function (x, ...) 
NULL
&gt; args(sum)
function (..., na.rm = FALSE) 
NULL
&gt;
</pre>

<p>
Ouch. That is not nice at all!
</p>
</div>
</div>

<div id="outline-container-orgheadline56" class="outline-3">
<h3 id="orgheadline56">Trouble with Factors</h3>
<div class="outline-text-3" id="text-orgheadline56">
<p>
Factors sometimes behave as numbers, and sometimes as characters, which can be confusing!
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock36"><span style="color: #2f96dc;">(</span>x <span style="color: #a45bad;">&lt;-</span> factor<span style="color: #bc6ec5;">(</span>c<span style="color: #2d9574;">(</span>5, 5, 6, 6<span style="color: #2d9574;">)</span>, levels = c<span style="color: #2d9574;">(</span>6, 5<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>

str<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>

as.character<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
<span style="color: #2aa198;"># </span><span style="color: #2aa198;">here is where people sometimes get lost...</span>
as.numeric<span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span>
<span style="color: #2aa198;"># </span><span style="color: #2aa198;">you probably want</span>
as.numeric<span style="color: #2f96dc;">(</span>as.character<span style="color: #bc6ec5;">(</span>x<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; (x &lt;- factor(c(5, 5, 6, 6), levels = c(6, 5)))
[1] 5 5 6 6
Levels: 6 5
&gt; 
&gt; str(x)
 Factor w/ 2 levels "6","5": 2 2 1 1
&gt; 
&gt; as.character(x)
[1] "5" "5" "6" "6"
&gt; # here is where people sometimes get lost...
&gt; as.numeric(x)
[1] 2 2 1 1
&gt; # you probably want
&gt; as.numeric(as.character(x))
[1] 5 5 6 6
&gt;
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline64" class="outline-2">
<h2 id="orgheadline64">Exercise solutions</h2>
<div class="outline-text-2" id="text-orgheadline64">
</div><div id="outline-container-orgheadline58" class="outline-3">
<h3 id="orgheadline58">Exercise 0 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
</div>

<div id="outline-container-orgheadline59" class="outline-3">
<h3 id="orgheadline59">Exercise 0</h3>
<div class="outline-text-3" id="text-orgheadline59">
<p>
Use the built-in <i>iris</i> data set (comes with R, will be available in your workspace automatically).
</p>
<ol class="org-ol">
<li value="1">Determine the <code>class</code> and <code>str</code> ucture of the <i>iris</i> data set.</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">class<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
str<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; class(iris)
[1] "data.frame"
&gt; str(iris)
'data.frame':	150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
&gt;
</pre>

<ol class="org-ol">
<li value="2">Determine the class of each column in the iris data set</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">class<span style="color: #2f96dc;">(</span>iris$Species<span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>iris$Sepal.Length<span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>iris$Sepal.Width<span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>iris$Petal.Length<span style="color: #2f96dc;">)</span>
class<span style="color: #2f96dc;">(</span>iris$Petal.Width<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; class(iris$Species)
[1] "factor"
&gt; class(iris$Sepal.Length)
[1] "numeric"
&gt; class(iris$Sepal.Width)
[1] "numeric"
&gt; class(iris$Petal.Length)
[1] "numeric"
&gt; class(iris$Petal.Width)
[1] "numeric"
&gt;
</pre>

<ol class="org-ol">
<li value="3">BONUS (OPTIONAL): Create a new variable by <code>c</code> ombining the Petal.Length and Petal.Width columns</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">petal <span style="color: #a45bad;">&lt;-</span> c<span style="color: #2f96dc;">(</span>iris$Petal.Length, iris$Petal.Width<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; petal &lt;- c(iris$Petal.Length, iris$Petal.Width)
&gt;
</pre>

<ol class="org-ol">
<li value="4">BONUS (OPTIONAL): Create a new data.frame with two columns; the first should be named <i>value</i>, and should be equal to the variable you created in step 3. The second should be named <i>variable</i> and should be either <i>Petal.Length</i> or <i>Petal.Width</i> as appropriate.</li>
</ol>
<div class="org-src-container">

<pre class="src src-R">petals <span style="color: #a45bad;">&lt;-</span> data.frame<span style="color: #2f96dc;">(</span>value = petal,
                     variable = rep<span style="color: #bc6ec5;">(</span>c<span style="color: #2d9574;">(</span><span style="color: #2d9574;">"Petal.Length"</span>, <span style="color: #2d9574;">"Petal.Width"</span><span style="color: #2d9574;">)</span>,
                                    each = nrow<span style="color: #2d9574;">(</span>iris<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>

head<span style="color: #2f96dc;">(</span>petals<span style="color: #2f96dc;">)</span>
tail<span style="color: #2f96dc;">(</span>petals<span style="color: #2f96dc;">)</span>
</pre>
</div>

<pre class="example">
&gt; petals &lt;- data.frame(value = petal,
+                      variable = rep(c("Petal.Length", "Petal.Width"),
+                                     each = nrow(iris)))
&gt; 
&gt; head(petals)
  value     variable
1   1.4 Petal.Length
2   1.4 Petal.Length
3   1.3 Petal.Length
4   1.5 Petal.Length
5   1.4 Petal.Length
6   1.7 Petal.Length
&gt; tail(petals)
    value    variable
295   2.5 Petal.Width
296   2.3 Petal.Width
297   1.9 Petal.Width
298   2.0 Petal.Width
299   2.3 Petal.Width
300   1.8 Petal.Width
&gt;
</pre>
</div>
</div>


<div id="outline-container-orgheadline60" class="outline-3">
<h3 id="orgheadline60">Exercise 1 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline60">
<ol class="org-ol">
<li value="1">Select just the Sepal.Length and Species columns from the <i>iris</i> data set (built-in, will be available in your workspace automatically) and save the result to a new data.frame named <i>iris.2</i></li>
</ol>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock37">data<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
iris2 <span style="color: #a45bad;">&lt;-</span> iris<span style="color: #2f96dc;">[</span>c<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"Sepal.Length"</span>, <span style="color: #2d9574;">"Species"</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">]</span>
str<span style="color: #2f96dc;">(</span>iris2<span style="color: #2f96dc;">)</span>
</pre>
</div>

<ol class="org-ol">
<li value="2">Calculate the mean of the Sepal.Length column in <i>iris.2</i></li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock38">mean<span style="color: #2f96dc;">(</span>iris2<span style="color: #bc6ec5;">[</span> , <span style="color: #2d9574;">"Sepal.Length"</span><span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<ol class="org-ol">
<li value="3">BONUS (optional): Calculate the mean of Sepal.Length, but only for the setosa species</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock39">mean<span style="color: #2f96dc;">(</span>iris2<span style="color: #bc6ec5;">[</span>iris2<span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #2d9574;">"Species"</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span> == <span style="color: #2d9574;">"setosa"</span>, <span style="color: #2d9574;">"Sepal.Length"</span><span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span>
<span style="color: #2aa198;">## </span><span style="color: #2aa198;">shortcut:</span>
with<span style="color: #2f96dc;">(</span>iris2, <span style="color: #bc6ec5;">{</span>
    print<span style="color: #2d9574;">(</span>mean<span style="color: #67b11d;">(</span>Sepal.Length<span style="color: #b1951d;">[</span>Species == <span style="color: #2d9574;">"setosa"</span><span style="color: #b1951d;">]</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>
<span style="color: #bc6ec5;">}</span><span style="color: #2f96dc;">)</span>
</pre>
</div>

<ol class="org-ol">
<li value="4">BONUS (optional): Calculate the number of sepal lengths that are more than one standard deviation below the average sepal length</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock40">m.minus.sd <span style="color: #a45bad;">&lt;-</span> mean<span style="color: #2f96dc;">(</span>iris2<span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #2d9574;">"Sepal.Length"</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span> - sd<span style="color: #2f96dc;">(</span>iris2<span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">[</span><span style="color: #2d9574;">"Sepal.Length"</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span>
length<span style="color: #2f96dc;">(</span>iris2<span style="color: #bc6ec5;">[</span>iris2<span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span><span style="color: #2d9574;">"Sepal.Length"</span><span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span> &lt; m.minus.sd, <span style="color: #2d9574;">"Sepal.Length"</span><span style="color: #bc6ec5;">]</span><span style="color: #2f96dc;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline61" class="outline-3">
<h3 id="orgheadline61">Exercise 2 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline61">
<ol class="org-ol">
<li value="1">Write a function that takes a data.frame as an argument and returns the mean of each numeric column in the data frame. Test your function using the iris data.</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock41"><span style="color: #bc6ec5; font-weight: bold;">statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>df<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    classes <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df, class<span style="color: #bc6ec5;">)</span>
    means <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>means<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>

statsum<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>


<ol class="org-ol">
<li value="2">Modify your function so that it returns a list, the first element if which is the means of the numeric variables, the second of which is the counts of the levels of each categorical variable.</li>
</ol>
<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock42"><span style="color: #bc6ec5; font-weight: bold;">statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>df<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    classes <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df, class<span style="color: #bc6ec5;">)</span>
    means <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    counts <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"factor"</span><span style="color: #2d9574;">]</span>, table<span style="color: #bc6ec5;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>list<span style="color: #2d9574;">(</span>means, counts<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>

statsum<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgheadline62" class="outline-3">
<h3 id="orgheadline62">Exercise 3 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline62">
<ol class="org-ol">
<li value="1">Add argument checking code to return an error if the argument to your function is not a data.frame</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock43"><span style="color: #bc6ec5; font-weight: bold;">statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>df<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    <span style="color: #237fbf; font-weight: bold;">if</span><span style="color: #bc6ec5;">(</span>class<span style="color: #2d9574;">(</span>df<span style="color: #2d9574;">)</span> != <span style="color: #2d9574;">"data.frame"</span><span style="color: #bc6ec5;">)</span> <span style="color: #237fbf; font-weight: bold;">stop</span><span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"df must be a data.frame!"</span><span style="color: #bc6ec5;">)</span>
    classes <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df, class<span style="color: #bc6ec5;">)</span>
    means <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    counts <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"factor"</span><span style="color: #2d9574;">]</span>, table<span style="color: #bc6ec5;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>list<span style="color: #2d9574;">(</span>means, counts<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>

statsum<span style="color: #2f96dc;">(</span>1:10<span style="color: #2f96dc;">)</span>
statsum<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>

<ol class="org-ol">
<li value="2">Insert a break point with <code>browser()</code> and step through your function</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock44"><span style="color: #bc6ec5; font-weight: bold;">statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>df<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    <span style="color: #237fbf; font-weight: bold;">if</span><span style="color: #bc6ec5;">(</span>class<span style="color: #2d9574;">(</span>df<span style="color: #2d9574;">)</span> != <span style="color: #2d9574;">"data.frame"</span><span style="color: #bc6ec5;">)</span> <span style="color: #237fbf; font-weight: bold;">stop</span><span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"df must be a data.frame!"</span><span style="color: #bc6ec5;">)</span>
browser<span style="color: #bc6ec5;">()</span>
    classes <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df, class<span style="color: #bc6ec5;">)</span>
    means <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    counts <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"factor"</span><span style="color: #2d9574;">]</span>, table<span style="color: #bc6ec5;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>list<span style="color: #2d9574;">(</span>means, counts<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
<span style="color: #2f96dc;">}</span>

statsum<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-orgheadline63" class="outline-3">
<h3 id="orgheadline63">Exercise 4 prototype&#xa0;&#xa0;&#xa0;<span class="tag"><span class="prototype">prototype</span></span></h3>
<div class="outline-text-3" id="text-orgheadline63">
<ol class="org-ol">
<li value="1">Modify your function so that it also returns the standard deviations of the numeric variables</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock45"><span style="color: #bc6ec5; font-weight: bold;">statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>df<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    <span style="color: #237fbf; font-weight: bold;">if</span><span style="color: #bc6ec5;">(</span>class<span style="color: #2d9574;">(</span>df<span style="color: #2d9574;">)</span> != <span style="color: #2d9574;">"data.frame"</span><span style="color: #bc6ec5;">)</span> <span style="color: #237fbf; font-weight: bold;">stop</span><span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"df must be a data.frame!"</span><span style="color: #bc6ec5;">)</span>
    classes <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df, class<span style="color: #bc6ec5;">)</span>
    means <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    sds <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    counts <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"factor"</span><span style="color: #2d9574;">]</span>, table<span style="color: #bc6ec5;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>list<span style="color: #2d9574;">(</span>cbind<span style="color: #67b11d;">(</span>means, sds<span style="color: #67b11d;">)</span>, counts<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>

statsum<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>

<ol class="org-ol">
<li value="2">Modify your function so that it returns a list of class "statsum"</li>
</ol>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock46"><span style="color: #bc6ec5; font-weight: bold;">statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>df<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    <span style="color: #237fbf; font-weight: bold;">if</span><span style="color: #bc6ec5;">(</span>class<span style="color: #2d9574;">(</span>df<span style="color: #2d9574;">)</span> != <span style="color: #2d9574;">"data.frame"</span><span style="color: #bc6ec5;">)</span> <span style="color: #237fbf; font-weight: bold;">stop</span><span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"df must be a data.frame!"</span><span style="color: #bc6ec5;">)</span>
    classes <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df, class<span style="color: #bc6ec5;">)</span>
    means <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    sds <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"numeric"</span><span style="color: #2d9574;">]</span>, mean<span style="color: #bc6ec5;">)</span>
    counts <span style="color: #a45bad;">&lt;-</span> sapply<span style="color: #bc6ec5;">(</span>df<span style="color: #2d9574;">[</span>classes == <span style="color: #2d9574;">"factor"</span><span style="color: #2d9574;">]</span>, table<span style="color: #bc6ec5;">)</span>
    R <span style="color: #a45bad;">&lt;-</span> list<span style="color: #bc6ec5;">(</span>cbind<span style="color: #2d9574;">(</span>means, sds<span style="color: #2d9574;">)</span>, counts<span style="color: #bc6ec5;">)</span>
    class<span style="color: #bc6ec5;">(</span>R<span style="color: #bc6ec5;">)</span> <span style="color: #a45bad;">&lt;-</span> c<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"statsum"</span>, class<span style="color: #2d9574;">(</span>R<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span>
    <span style="color: #237fbf; font-weight: bold;">return</span><span style="color: #bc6ec5;">(</span>R<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">}</span>

str<span style="color: #2f96dc;">(</span>statsum<span style="color: #bc6ec5;">(</span>iris<span style="color: #bc6ec5;">)</span><span style="color: #2f96dc;">)</span>
</pre>
</div>


<p>
3 [@3] Write a print method for the statsum class
</p>

<div class="org-src-container">

<pre class="src src-R" id="orgsrcblock47"><span style="color: #bc6ec5; font-weight: bold;">print.statsum</span> <span style="color: #a45bad;">&lt;-</span> <span style="color: #237fbf; font-weight: bold;">function</span><span style="color: #2f96dc;">(</span>x<span style="color: #2f96dc;">)</span> <span style="color: #2f96dc;">{</span>
    cat<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"Numeric variable descriptive statistics:\n"</span><span style="color: #bc6ec5;">)</span>
    print<span style="color: #bc6ec5;">(</span>x<span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span>1<span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span>, digits=2<span style="color: #bc6ec5;">)</span> 
    cat<span style="color: #bc6ec5;">(</span><span style="color: #2d9574;">"Factor variable counts:\n"</span><span style="color: #bc6ec5;">)</span>
    print<span style="color: #bc6ec5;">(</span>x<span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span>2<span style="color: #67b11d;">]</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">)</span>
<span style="color: #2f96dc;">}</span>

statsum<span style="color: #2f96dc;">(</span>iris<span style="color: #2f96dc;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgheadline67" class="outline-2">
<h2 id="orgheadline67">Additional resources</h2>
<div class="outline-text-2" id="text-orgheadline67">
</div><div id="outline-container-orgheadline65" class="outline-3">
<h3 id="orgheadline65">Additional reading and resources</h3>
<div class="outline-text-3" id="text-orgheadline65">
<ul class="org-ul">
<li>Learn from the best: <a href="http://adv-r.had.co.nz/">http://adv-r.had.co.nz/</a></li>
<li>S3 system overview: <a href="https://github.com/hadley/devtools/wiki/S3">https://github.com/hadley/devtools/wiki/S3</a></li>
<li>S4 system overview: <a href="https://github.com/hadley/devtools/wiki/S4">https://github.com/hadley/devtools/wiki/S4</a></li>
<li>R documentation: <a href="http://cran.r-project.org/manuals.html">http://cran.r-project.org/manuals.html</a></li>
<li>Collection of R tutorials: <a href="http://cran.r-project.org/other-docs.html">http://cran.r-project.org/other-docs.html</a></li>

<li>R for Programmers (by Norman Matloff, UC&#x2013;Davis)</li>
</ul>
<p>
<a href="http://heather.cs.ucdavis.edu/~matloff/R/RProg.pdf">http://heather.cs.ucdavis.edu/~matloff/R/RProg.pdf</a>
</p>
<ul class="org-ul">
<li>Calling C and Fortran from R (by Charles Geyer, UMinn)</li>
</ul>
<p>
<a href="http://www.stat.umn.edu/~charlie/rc/">http://www.stat.umn.edu/~charlie/rc/</a>
</p>
<ul class="org-ul">
<li>State of the Art in Parallel Computing with R (Schmidberger et al.)</li>
</ul>
<p>
<a href="http://www.jstatso%7C.org/v31/i01/paper">http://www.jstatso%7C.org/v31/i01/paper</a>
</p>

<ul class="org-ul">
<li>Institute for Quantitative Social Science: <a href="http://iq.harvard.edu/">http://iq.harvard.edu/</a></li>
<li>Research technology consulting: <a href="http://projects.iq.harvard.edu/rtc">http://projects.iq.harvard.edu/rtc</a></li>
</ul>
</div>
</div>


<div id="outline-container-orgheadline66" class="outline-3">
<h3 id="orgheadline66">Feedback</h3>
<div class="outline-text-3" id="text-orgheadline66">
<ul class="org-ul">
<li>Help Us Make This Workshop Better!</li>
<li>Please take a moment to fill out a very short feedback form</li>
<li>These workshops exist for you &#x2013; tell us what you need!</li>
<li><a href="http://tinyurl.com/RprogrammingFeedback">http://tinyurl.com/RprogrammingFeedback</a></li>
</ul>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
Center for Economic and Policy Research. 2015. CPS ORG Uniform Extracts, Version 2.0.1. Washington, DC.
</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2">2</a></sup> <div class="footpara"><p class="footpara">
<a href="http://stackoverflow.com/questions/4683046/regular-expression-for-extracting-script-tags">http://stackoverflow.com/questions/4683046/regular-expression-for-extracting-script-tags</a> 
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p><a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'><img alt='Creative Commons License' style='border-width:0' src='https://i.creativecommons.org/l/by-sa/4.0/80x15.png' /></a><span xmlns:dct='http://purl.org/dc/terms/' property='dct:title'> These statistical software workshop materials</span> by <a xmlns:cc='http://creativecommons.org/ns#' href='http://rtc.iq.harvard.edu' property='cc:attributionName' rel='cc:attributionURL'>Harvard University</a> are licensed under a <a rel='license' href='http://creativecommons.org/licenses/by-sa/4.0/'>Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p> <p> Presented by <a href='http://rtc.iq.harvard.edu'>Research Technology Consulting</a> at <br></br> <a href='http://iq.harvard.edu'><img style='margin-left: auto; margin-right: auto;' alt='The Institute for Quantitative Social Science' title='IQSS logo' src='http://static.projects.iq.harvard.edu/files/styles/os_files_small/public/rtc/files/iqsslogo-2014_0.png'></img></a></p>
</div>
</body>
</html>
